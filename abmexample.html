

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Example &mdash; ActivitySim 0.5 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="ActivitySim 0.5 documentation" href="index.html"/>
        <link rel="next" title="How the System Works" href="howitworks.html"/>
        <link rel="prev" title="Getting Started" href="gettingstarted.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ActivitySim
          

          
          </a>

          
            
            
              <div class="version">
                0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#folder-file-setup">Folder/File Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inputs">Inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#chunk-size">Chunk size</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logging">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#model-specification-files">Model Specification Files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#running-the-example-model">Running the Example Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pipeline">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="#outputs">Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tracing">Tracing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="howitworks.html">How the System Works</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataschema.html">Data Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ActivitySim</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Example</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/abmexample.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="example">
<span id="id1"></span><h1>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h1>
<p>This page describes how to setup and run the example AB model, as well as how it works.  The example
is limited to a small sample of households and zones so that it can be run quickly and require
less than 1 GB of RAM.</p>
<span class="target" id="index-0"></span><div class="section" id="folder-file-setup">
<span id="index-1"></span><h2>Folder/File Setup<a class="headerlink" href="#folder-file-setup" title="Permalink to this headline">¶</a></h2>
<p>The example has the following root folder/file setup:</p>
<blockquote>
<div><ul class="simple">
<li>configs - settings, expressions files, etc.</li>
<li>data - input data such as land use, synthetic population files, and skims</li>
<li>simulation.py - main script to run the model</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="inputs">
<h2>Inputs<a class="headerlink" href="#inputs" title="Permalink to this headline">¶</a></h2>
<p>In order to run the example, you first need two input files in the <code class="docutils literal"><span class="pre">data</span></code> folder as identified in the <code class="docutils literal"><span class="pre">configs\settings.yaml</span></code> file:</p>
<ul>
<li><p class="first">store: mtc_asim.h5 - an HDF5 file containing the following MTC travel model one tables as pandas DataFrames for a subset of zones:</p>
<blockquote>
<div><ul class="simple">
<li>skims/accessibility - Zone-based accessibility measures</li>
<li>land_use/taz_data - Zone-based land use data (population and employment for example)</li>
<li>persons - Synthetic population person records</li>
<li>households - Synthetic population household records</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">skims_file: skims.omx - an OMX matrix file containing the MTC travel model one skim matrices for a subset of zones.</p>
</li>
</ul>
<p>Both of these files are used in the tests as well and are available here <code class="docutils literal"><span class="pre">activitysim\defaults\test\data</span></code>.  Alternatively,
these files can be downloaded from the SF 25 zone example example data folder on
MTC’s <a class="reference external" href="https://mtcdrive.app.box.com/v/activitysim">box account</a>.  Both files can
be viewed with the <a class="reference external" href="https://github.com/osPlanning/omx/wiki/OMX-Viewer">OMX Viewer</a>.
The pandas DataFrames are stored in an efficient pandas format within the HDF5 file so they are a
bit cumbersome to inspect.</p>
<p>The <code class="docutils literal"><span class="pre">scripts\data_mover.ipynb</span></code> was used to create the mtc_asim.h5 file from the raw CSV files.
This script reads the CSV files, creates DataFrame indexes, and writes the pandas objects to the HDF5
file.</p>
<p>The full set of MTC travel model one OMX skims are also on the box account. The <code class="docutils literal"><span class="pre">scripts\build_omx.py</span></code> script
will build one OMX file containing all the skims. The original MTC travel model one skims were converted from
Cube to OMX using the <a class="reference external" href="https://github.com/osPlanning/omx/wiki/Cube-OMX-Converter">Cube to OMX converter</a>.</p>
<p>Finally, the example inputs were created by the <code class="docutils literal"><span class="pre">scripts\create_sf_example.py</span></code> script,
which creates the land use, synthetic population, and skim inputs for a subset of user-defined zones.</p>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">configs</span></code> folder contains settings, expressions files, and other files required for specifying
model utilities and form.  The first place to start in the <code class="docutils literal"><span class="pre">configs</span></code> folder is <code class="docutils literal"><span class="pre">settings.yaml</span></code>, which
is the main settings file for the model run.  This file includes:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">models</span></code> - list of model steps to run - auto ownership, tour frequency, etc. - see <a class="reference internal" href="#model-steps"><span class="std std-ref">Pipeline</span></a></p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">store</span></code> - HDF5 inputs file</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">skims_file</span></code> - skim matrices in one OMX file</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">households_sample_size</span></code> - number of households to sample and simulate; comment out to simulate all households</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">trace_hh_id</span></code> - trace household id; comment out for no trace</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">trace_od</span></code> - trace origin, destination pair in accessibility calculation; comment out for no trace</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">chunk_size</span></code> - batch size for processing choosers, see <a class="reference internal" href="#chunk-size"><span class="std std-ref">Chunk size</span></a></p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">check_for_variability</span></code> - disable check for variability in an expression result debugging feature in order to speed-up runtime</p>
</li>
<li><p class="first">global variables that can be used in expressions tables and Python code such as:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">urban_threshold</span></code> - urban threshold area type max value</li>
<li><code class="docutils literal"><span class="pre">county_map</span></code> - mapping of county codes to county names</li>
<li><code class="docutils literal"><span class="pre">skim_time_periods</span></code> - time period upper bound values and labels</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="section" id="chunk-size">
<span id="index-2"></span><span id="id2"></span><h3>Chunk size<a class="headerlink" href="#chunk-size" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">chunk_size</span></code> is the number of doubles in a chunk of the choosers table.  It is the number of rows
times the number of columns and it needs to be set to a value that efficiently processes the table with
the available RAM.  For example, a chunk size of 1,000,000 could be 100,000 households with 10 attribute
columns.  Setting the chunk size too high will run into memory errors such as <code class="docutils literal"><span class="pre">OverflowError:</span> <span class="pre">Python</span> <span class="pre">int</span>
<span class="pre">too</span> <span class="pre">large</span> <span class="pre">to</span> <span class="pre">convert</span> <span class="pre">to</span> <span class="pre">C</span> <span class="pre">long.</span></code> Setting the chunk size too low may result in smaller than optimal vector
lengths, which may waste runtime.  The chunk size is dependent on the size of the population, the complexity
of the utility expressions, the amount of RAM on the machine, and other problem specific dimensions.  Thus,
it needs to be set via experimentation.</p>
</div>
<div class="section" id="logging">
<h3>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h3>
<p>Included in the <code class="docutils literal"><span class="pre">configs</span></code> folder is the <code class="docutils literal"><span class="pre">logging.yaml</span></code>, which configures Python logging
library and defines two key log files:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">asim.log</span></code> - overall system log file</li>
<li><code class="docutils literal"><span class="pre">hhtrace.log</span></code> - household trace log file if tracing is on</li>
</ul>
<p>Refer to the <a class="reference internal" href="#tracing"><span class="std std-ref">Tracing</span></a> section for more detail on tracing.</p>
</div>
<div class="section" id="model-specification-files">
<h3>Model Specification Files<a class="headerlink" href="#model-specification-files" title="Permalink to this headline">¶</a></h3>
<p>Included in the <code class="docutils literal"><span class="pre">configs</span></code> folder are the model specification files that store the
Python/pandas/numpy expressions, alternatives, and other settings used by each model.  Some models includes an
alternatives file since the alternatives are not easily described as columns in the expressions file.  An example
of this is the <code class="docutils literal"><span class="pre">non_mandatory_tour_frequency_alternatives.csv</span></code> file, which lists each alternative as a row and each
columns indicates the number of non-mandatory tours by purpose.  The current set of files are below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Model</th>
<th class="head">Specification Files</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="models.html#accessibility"><span class="std std-ref">Accessibility</span></a></td>
<td><ul class="first last simple">
<li>accessibility.yaml</li>
<li>accessibility.csv</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="models.html#school-location"><span class="std std-ref">School Location</span></a></td>
<td><ul class="first last simple">
<li>school_location.yaml</li>
<li>school_location_sample.csv</li>
<li>logsums_spec_school.csv</li>
<li>logsums_spec_university.csv</li>
<li>school_location.csv</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="models.html#work-location"><span class="std std-ref">Workplace Location</span></a></td>
<td><ul class="first last simple">
<li>workplace_location.yaml</li>
<li>workplace_location_sample.csv</li>
<li>logsums_spec_work.csv</li>
<li>workplace_location.csv</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="models.html#auto-ownership"><span class="std std-ref">Auto Ownership</span></a></td>
<td><ul class="first last simple">
<li>auto_ownership.yaml</li>
<li>auto_ownership.csv</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="models.html#cdap"><span class="std std-ref">Coordinated Daily Activity Pattern</span></a></td>
<td><ul class="first last simple">
<li>cdap.yaml</li>
<li>cdap_indiv_and_hhsize1.csv</li>
<li>cdap_interaction_coefficients.csv</li>
<li>cdap_fixed_relative_proportions.csv</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="models.html#mandatory-tour-frequency"><span class="std std-ref">Mandatory Tour Frequency</span></a></td>
<td><ul class="first last simple">
<li>mandatory_tour_frequency.csv</li>
<li>mandatory_tour_frequency_alternatives.csv</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="models.html#mandatory-tour-scheduling"><span class="std std-ref">Mandatory Tour Scheduling</span></a></td>
<td><ul class="first last simple">
<li>tour_departure_and_duration_alternatives.csv</li>
<li>tour_departure_and_duration_school.csv</li>
<li>tour_departure_and_duration_work.csv</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="models.html#non-mandatory-tour-frequency"><span class="std std-ref">Non-Mandatory Tour Frequency</span></a></td>
<td><ul class="first last simple">
<li>non_mandatory_tour_frequency.csv</li>
<li>non_mandatory_tour_frequency_alternatives.csv</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="models.html#non-mandatory-tour-destination-choice"><span class="std std-ref">Non-Mandatory Tour Destination Choice</span></a></td>
<td><ul class="first last simple">
<li>non_mandatory_tour_destination_choice.yaml</li>
<li>non_mandatory_tour_destination_choice.csv</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="models.html#non-mandatory-tour-scheduling"><span class="std std-ref">Non-Mandatory Tour Scheduling</span></a></td>
<td><ul class="first last simple">
<li>tour_departure_and_duration_alternatives.csv</li>
<li>tour_departure_and_duration_nonmandatory.csv</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="models.html#annotate-table"><span class="std std-ref">Annotate Table</span></a> model_name=annotate_tours</td>
<td><ul class="first last simple">
<li>annotate_tours.csv</li>
<li>annotate_tours.yaml</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="models.html#tour-mode-choice"><span class="std std-ref">Tour Mode</span></a></td>
<td><ul class="first last simple">
<li>tour_mode_choice.yaml</li>
<li>tour_mode_choice.csv</li>
<li>tour_mode_choice_coeffs.csv</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="models.html#atwork-subtour-frequency"><span class="std std-ref">At-work Subtours Frequency</span></a></td>
<td><ul class="first last simple">
<li>atwork_subtour_frequency.csv</li>
<li>atwork_subtour_frequency_alternatives.csv</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="models.html#atwork-subtour-destination"><span class="std std-ref">At-work Subtours Destination Choice</span></a></td>
<td><ul class="first last simple">
<li>atwork_subtour_destination.yaml</li>
<li>atwork_subtour_destination_sample.csv</li>
<li>atwork_subtour_destination.csv</li>
<li>logsums_spec_work.csv</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="models.html#atwork-subtour-scheduling"><span class="std std-ref">At-work Subtour Scheduling</span></a></td>
<td><ul class="first last simple">
<li>tour_departure_and_duration_subtour.csv</li>
<li>tour_departure_and_duration_alternatives.csv</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="models.html#atwork-subtour-mode-choice"><span class="std std-ref">At-work Subtour Mode</span></a></td>
<td><ul class="first last simple">
<li>tour_mode_choice.yaml</li>
<li>tour_mode_choice.csv</li>
<li>tour_mode_choice_coeffs.csv</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="models.html#trip-mode-choice"><span class="std std-ref">Trip Mode</span></a></td>
<td><ul class="first last simple">
<li>trip_mode_choice.yaml</li>
<li>trip_mode_choice.csv</li>
<li>trip_mode_choice_coeffs.csv</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="running-the-example-model">
<h2>Running the Example Model<a class="headerlink" href="#running-the-example-model" title="Permalink to this headline">¶</a></h2>
<p>To run the example, do the following:</p>
<ul class="simple">
<li>Open a command line window in the <code class="docutils literal"><span class="pre">example</span></code> folder</li>
<li>Activate the correct conda environment if needed</li>
<li>Run <code class="docutils literal"><span class="pre">python</span> <span class="pre">simulation.py</span></code> to run the data pipeline (i.e. model steps)</li>
<li>ActivitySim should log some information and write outputs to the <code class="docutils literal"><span class="pre">outputs</span></code> folder.</li>
</ul>
<p>The example should complete within a couple minutes since it is running a small sample of households.</p>
</div>
<div class="section" id="pipeline">
<span id="model-steps"></span><h2>Pipeline<a class="headerlink" href="#pipeline" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">models</span></code> setting contains the specification of the data pipeline model steps, as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">models</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">initialize</span>
  <span class="o">-</span> <span class="n">compute_accessibility</span>
  <span class="o">-</span> <span class="n">school_location_sample</span>
  <span class="o">-</span> <span class="n">school_location_logsums</span>
  <span class="o">-</span> <span class="n">school_location_simulate</span>
  <span class="o">-</span> <span class="n">workplace_location_sample</span>
  <span class="o">-</span> <span class="n">workplace_location_logsums</span>
  <span class="o">-</span> <span class="n">workplace_location_simulate</span>
  <span class="o">-</span> <span class="n">auto_ownership_simulate</span>
  <span class="o">-</span> <span class="n">cdap_simulate</span>
  <span class="o">-</span> <span class="n">mandatory_tour_frequency</span>
  <span class="o">-</span> <span class="n">mandatory_tour_scheduling</span>
  <span class="o">-</span> <span class="n">non_mandatory_tour_frequency</span>
  <span class="o">-</span> <span class="n">non_mandatory_tour_destination_choice</span>
  <span class="o">-</span> <span class="n">non_mandatory_tour_scheduling</span>
  <span class="o">-</span> <span class="n">annotate_table</span><span class="o">.</span><span class="n">model_name</span><span class="o">=</span><span class="n">annotate_tours</span>
  <span class="o">-</span> <span class="n">tour_mode_choice_simulate</span>
  <span class="o">-</span> <span class="n">atwork_subtour_frequency</span>
  <span class="o">-</span> <span class="n">atwork_subtour_destination_sample</span>
  <span class="o">-</span> <span class="n">atwork_subtour_destination_logsums</span>
  <span class="o">-</span> <span class="n">atwork_subtour_destination_simulate</span>
  <span class="o">-</span> <span class="n">atwork_subtour_scheduling</span>
  <span class="o">-</span> <span class="n">atwork_subtour_mode_choice_simulate</span>
  <span class="o">-</span> <span class="n">create_simple_trips</span>
  <span class="o">-</span> <span class="n">trip_mode_choice_simulate</span>
</pre></div>
</div>
<p>These model steps must be registered orca steps, as noted below.  If you provide a <code class="docutils literal"><span class="pre">resume_after</span></code>
argument to <a class="reference internal" href="core.html#activitysim.core.pipeline.run" title="activitysim.core.pipeline.run"><code class="xref py py-func docutils literal"><span class="pre">activitysim.core.pipeline.run()</span></code></a> the pipeliner will load checkpointed tables from the checkpoint store
and resume pipeline processing on the next model step after the specified checkpoint.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">resume_after</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1">#resume_after = &#39;school_location_logsums&#39;</span>
</pre></div>
</div>
<p>The model is run by calling the <a class="reference internal" href="core.html#activitysim.core.pipeline.run" title="activitysim.core.pipeline.run"><code class="xref py py-func docutils literal"><span class="pre">activitysim.core.pipeline.run()</span></code></a> method.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">models</span><span class="o">=</span><span class="n">_MODELS</span><span class="p">,</span> <span class="n">resume_after</span><span class="o">=</span><span class="n">resume_after</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Permalink to this headline">¶</a></h2>
<p>The key output of ActivitySim is the HDF5 data pipeline file <code class="docutils literal"><span class="pre">outputs\pipeline.h5</span></code>.  This file contains the
state of the key data tables after each model step in which the table was modified.  The
<code class="docutils literal"><span class="pre">pd.io.pytables.HDFStore('output\pipeline.h5')</span></code> command returns the following information about
the datastore.  You can see that the number of columns changes as each model step is run.  The checkpoints
table stores the crosswalk between model steps and table states in order to reload tables for restarting
the pipeline at any step.</p>
<table border="1" class="docutils">
<colgroup>
<col width="73%" />
<col width="7%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Table</th>
<th class="head">Type</th>
<th class="head">[Rows, Columns]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>/checkpoints</td>
<td>frame</td>
<td>(shape-&gt;[25,13])</td>
</tr>
<tr class="row-odd"><td>/land_use/initialize</td>
<td>frame</td>
<td>(shape-&gt;[25,49])</td>
</tr>
<tr class="row-even"><td>/accessibility/school_location_sample</td>
<td>frame</td>
<td>(shape-&gt;[25,20])</td>
</tr>
<tr class="row-odd"><td>/households/initialize</td>
<td>frame</td>
<td>(shape-&gt;[100,64])</td>
</tr>
<tr class="row-even"><td>/households/auto_ownership_simulate</td>
<td>frame</td>
<td>(shape-&gt;[100,67])</td>
</tr>
<tr class="row-odd"><td>/households/cdap_simulate</td>
<td>frame</td>
<td>(shape-&gt;[100,68])</td>
</tr>
<tr class="row-even"><td>/persons/initialize</td>
<td>frame</td>
<td>(shape-&gt;[154,50])</td>
</tr>
<tr class="row-odd"><td>/persons/school_location_simulate</td>
<td>frame</td>
<td>(shape-&gt;[154,53])</td>
</tr>
<tr class="row-even"><td>/persons/cdap_simulate</td>
<td>frame</td>
<td>(shape-&gt;[154,63])</td>
</tr>
<tr class="row-odd"><td>/persons/mandatory_tour_frequency</td>
<td>frame</td>
<td>(shape-&gt;[154,68])</td>
</tr>
<tr class="row-even"><td>/persons/non_mandatory_tour_frequency</td>
<td>frame</td>
<td>(shape-&gt;[154,73])</td>
</tr>
<tr class="row-odd"><td>/persons/workplace_location_simulate</td>
<td>frame</td>
<td>(shape-&gt;[154,58])</td>
</tr>
<tr class="row-even"><td>/person_windows/initialize</td>
<td>frame</td>
<td>(shape-&gt;[154,21])</td>
</tr>
<tr class="row-odd"><td>/person_windows/mandatory_tour_scheduling</td>
<td>frame</td>
<td>(shape-&gt;[154,21])</td>
</tr>
<tr class="row-even"><td>/person_windows/non_mandatory_tour_scheduling</td>
<td>frame</td>
<td>(shape-&gt;[154,21])</td>
</tr>
<tr class="row-odd"><td>/tours/mandatory_tour_frequency</td>
<td>frame</td>
<td>(shape-&gt;[79,11])</td>
</tr>
<tr class="row-even"><td>/tours/mandatory_tour_scheduling</td>
<td>frame</td>
<td>(shape-&gt;[79,15])</td>
</tr>
<tr class="row-odd"><td>/tours/non_mandatory_tour_frequency</td>
<td>frame</td>
<td>(shape-&gt;[168,15])</td>
</tr>
<tr class="row-even"><td>/tours/non_mandatory_tour_destination_choice</td>
<td>frame</td>
<td>(shape-&gt;[168,15])</td>
</tr>
<tr class="row-odd"><td>/tours/non_mandatory_tour_scheduling</td>
<td>frame</td>
<td>(shape-&gt;[168,15])</td>
</tr>
<tr class="row-even"><td>/tours/annotate_table.model_name=annotate_tours</td>
<td>frame</td>
<td>(shape-&gt;[168,41])</td>
</tr>
<tr class="row-odd"><td>/tours/tour_mode_choice_simulate</td>
<td>frame</td>
<td>(shape-&gt;[168,42])</td>
</tr>
<tr class="row-even"><td>/tours/atwork_subtour_frequency</td>
<td>frame</td>
<td>(shape-&gt;[173,44])</td>
</tr>
<tr class="row-odd"><td>/tours/atwork_subtour_destination_simulate</td>
<td>frame</td>
<td>(shape-&gt;[173,44])</td>
</tr>
<tr class="row-even"><td>/tours/atwork_subtour_scheduling</td>
<td>frame</td>
<td>(shape-&gt;[173,44])</td>
</tr>
<tr class="row-odd"><td>/trips/create_simple_trips</td>
<td>frame</td>
<td>(shape-&gt;[336,8])</td>
</tr>
<tr class="row-even"><td>/trips/trip_mode_choice_simulate</td>
<td>frame</td>
<td>(shape-&gt;[336,9])</td>
</tr>
<tr class="row-odd"><td>/school_location_sample/school_location_sample</td>
<td>frame</td>
<td>(shape-&gt;[168,5])</td>
</tr>
<tr class="row-even"><td>/school_location_sample/school_location_logsums</td>
<td>frame</td>
<td>(shape-&gt;[168,6])</td>
</tr>
<tr class="row-odd"><td>/workplace_location_sample/workplace_location_sample</td>
<td>frame</td>
<td>(shape-&gt;[2196,4])</td>
</tr>
<tr class="row-even"><td>/workplace_location_sample/workplace_location_logsums</td>
<td>frame</td>
<td>(shape-&gt;[2196,5])</td>
</tr>
<tr class="row-odd"><td>/atwork_subtour_destination_sample/atwork_subtour_destination_sample</td>
<td>frame</td>
<td>(shape-&gt;[77,6])</td>
</tr>
<tr class="row-even"><td>/atwork_subtour_destination_sample/atwork_subtour_destination_logsums</td>
<td>frame</td>
<td>(shape-&gt;[77,7])</td>
</tr>
</tbody>
</table>
<p>The example <code class="docutils literal"><span class="pre">simulation.py</span></code> run model script also writes the final table to a CSV file
for illustrative purposes by using the <a class="reference internal" href="core.html#activitysim.core.pipeline.get_table" title="activitysim.core.pipeline.get_table"><code class="xref py py-func docutils literal"><span class="pre">activitysim.core.pipeline.get_table()</span></code></a> method.  This method
returns a pandas DataFrame, which can then be written to a CSV with the <code class="docutils literal"><span class="pre">to_csv(file_path)</span></code> method.</p>
<p>ActivitySim also writes log and trace files to the <code class="docutils literal"><span class="pre">outputs</span></code> folder.  The asim.log file, which
is the overall log file is always produced.  If tracing is specified, then trace files are output
as well.</p>
</div>
<div class="section" id="tracing">
<span id="id3"></span><h2>Tracing<a class="headerlink" href="#tracing" title="Permalink to this headline">¶</a></h2>
<p>There are two types of tracing in ActivtiySim: household and origin-destination (OD) pair.  If a household trace ID
is specified, then ActivitySim will output a comprehensive set of trace files for all
calculations for all household members:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">hhtrace.log</span></code> - household trace log file, which specifies the CSV files traced. The order of output files is consistent with the model sequence.</li>
<li><code class="docutils literal"><span class="pre">various</span> <span class="pre">CSV</span> <span class="pre">files</span></code> - every input, intermediate, and output data table - chooser, expressions/utilities, probabilities, choices, etc. - for the trace household for every sub-model</li>
</ul>
<p>If an OD pair trace is specified, then ActivitySim will output the acessibility calculations trace
file:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">accessibility.result.csv</span></code> - accessibility expression results for the OD pair</li>
</ul>
<p>With the set of output CSV files, the user can trace ActivitySim’s calculations in order to ensure they are correct and/or to
help debug data and/or logic errors.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="howitworks.html" class="btn btn-neutral float-right" title="How the System Works" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gettingstarted.html" class="btn btn-neutral" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright contributing authors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>