
############
Sample Data

# final_xxx files become the fake observed (survey) dataset

# use a different base seed so fake observed trips have different behavior from model
rng_base_seed: 1

# initialize.py has switch to write sampled raw data
write_raw_tables: True


############


TAG=_2K
HH=2000
DATASET=mtc_tm1_sf

ACTIVITYSIM_HOME=/Users/jeff.doyle/work/activitysim
INPUT_DATA=/Users/jeff.doyle/work/activitysim-data/$DATASET/data
ESTIMATION_DIR=$ACTIVITYSIM_HOME/sandbox/example_estimation

EXAMPLE_CONFIGS=$ACTIVITYSIM_HOME/activitysim/examples/example_mtc/configs
SCRIPTS=$ESTIMATION_DIR/scripts
LOCAL_CONFIGS=$ESTIMATION_DIR/build_example_data/configs_build
OUTPUT=$ESTIMATION_DIR/build_example_data/output_build$TAG
DATA=$ESTIMATION_DIR/data$TAG

# run this to create fake sample data (random seed 1)
python $SCRIPTS/simulation.py -hh $HH -d $INPUT_DATA -c $LOCAL_CONFIGS -c $EXAMPLE_CONFIGS -o $OUTPUT

# copy raw tables to data directory data$TAG/*.csv
cp $OUTPUT/raw_tables/*.csv $DATA/

# copy final_tables to data_100/survey_data/*.csv
cp $OUTPUT/final_*.csv $DATA/survey_data/

# copy omx to data_100/survey_data/*.csv
cp $INPUT_DATA/skims.omx $DATA/

# create survey_xxx.csv files households, persons, tours, joint_tour_participants
# DATA/final_xxx.csv -> DATA/survey_xxx.csv
python $SCRIPTS/extract_survey_data.py $DATA

# create override_xxx.csv files
python $SCRIPTS/infer.py $DATA $EXAMPLE_CONFIGS

wc -l $DATA/households.csv
wc -l $DATA/survey_data/override_households.csv

python $SCRIPTS/simulation.py -c ./configs -c $EXAMPLE_CONFIGS -d $DATA -o output$TAG
