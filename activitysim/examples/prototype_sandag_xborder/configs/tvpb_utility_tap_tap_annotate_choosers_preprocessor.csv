Description,Target,Expression

# set1,,
total IVT,total_ivt_set1,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'BUS_TOTALIVTT')"
total number of transfers,raw_transfers_set1,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'BUS_XFERS')"
commuter rail IVT,cr_ivt_set1,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'BUS_CMRIVTT')"
light rail IVT,lrt_ivt_set1,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'BUS_LRTIVTT')"
bus rapid transit red IVT,brt_red_ivt_set1,"los.get_tappairs3d(df.btap,df.atap,df.tod,'BUS_BRTREDIVTT')"
bus rapid transit yellow IVT,brt_yel_ivt_set1,"los.get_tappairs3d(df.btap,df.atap,df.tod,'BUS_BRTYELIVTT')"
express bus IVT,eb_ivt_set1,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'BUS_EXPIVTT')"
limited bus IVT,ltd_ivt_set1,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'BUS_LTDEXPIVTT')"
local bus IVT,lb_ivt_set1,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'BUS_BUSIVTT')"
first wait,first_wait_set1,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'BUS_FIRSTWAIT')"
transfer wait,xfer_wait_set1,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'BUS_XFERWAIT')"
total walk time,walk_time_set1,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'BUS_TOTALWALK')"
fare,fare_set1,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'BUS_FARE')"
Transit available,set1_available,"(total_ivt_set1 > 0) * (total_ivt_set1 < 99999)"
Number transfers,transfers_set1,"np.clip(raw_transfers_set1, a_min=None, a_max=4)"
commuter rail ASC,asc_cr_set1,"set1_available * np.where(cr_ivt_set1 > 0, cr_asc * c_ivt, 0)"
light rail ASC,asc_lrt_set1,"set1_available * np.where(asc_cr_set1==0, np.where(lrt_ivt_set1 > 0, lrt_asc * c_ivt, 0), asc_cr_set1)"
bus rapid transit ASC,asc_brt_set1,"set1_available * np.where(asc_lrt_set1==0, np.where(brt_red_ivt_set1 + brt_yel_ivt_set1 > 0, brt_asc * c_ivt, 0), asc_lrt_set1)"
express bus ASC,asc_eb_set1,"set1_available * np.where(asc_brt_set1==0, np.where(eb_ivt_set1 + ltd_ivt_set1 > 0, exp_asc * c_ivt, 0), asc_brt_set1)"

# set2,,
total IVT,total_ivt_set2,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'PREM_TOTALIVTT')"
total number of transfers,raw_transfers_set2,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'PREM_XFERS')"
commuter rail IVT,cr_ivt_set2,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'PREM_CMRIVTT')"
light rail IVT,lrt_ivt_set2,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'PREM_LRTIVTT')"
bus rapid transit red IVT,brt_red_ivt_set2,"los.get_tappairs3d(df.btap,df.atap,df.tod,'PREM_BRTREDIVTT')"
bus rapid transit yellow IVT,brt_yel_ivt_set2,"los.get_tappairs3d(df.btap,df.atap,df.tod,'PREM_BRTYELIVTT')"
express bus IVT,eb_ivt_set2,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'PREM_EXPIVTT')"
limited bus IVT,ltd_ivt_set2,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'PREM_LTDEXPIVTT')"
local bus IVT,lb_ivt_set2,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'PREM_BUSIVTT')"
first wait,first_wait_set2,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'PREM_FIRSTWAIT')"
transfer wait,xfer_wait_set2,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'PREM_XFERWAIT')"
total walk time,walk_time_set2,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'PREM_TOTALWALK')"
fare,fare_set2,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'PREM_FARE')"
Transit available,set2_available,"(total_ivt_set2 > 0) * (total_ivt_set2 < 99999)"
Number Transfers,transfers_set2,"np.clip(raw_transfers_set2, a_min=None, a_max=4)"
commuter rail ASC,asc_cr_set2,"set2_available * np.where(cr_ivt_set2 > 0, cr_asc * c_ivt, 0)"
light rail ASC,asc_lrt_set2,"set2_available * np.where(asc_cr_set2==0, np.where(lrt_ivt_set2 > 0, lrt_asc * c_ivt, 0), asc_cr_set2)"
bus rapid transit ASC,asc_brt_set2,"set2_available * np.where(asc_lrt_set2==0, np.where(brt_red_ivt_set2 + brt_yel_ivt_set2 > 0, brt_asc * c_ivt, 0), asc_lrt_set2)"
express bus ASC,asc_eb_set2,"set2_available * np.where(asc_brt_set2==0, np.where(eb_ivt_set2 + ltd_ivt_set2 > 0, exp_asc * c_ivt, 0), asc_brt_set2)"

# set3,,
total IVT,total_ivt_set3,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'ALLPEN_TOTALIVTT')"
total number of transfers,raw_transfers_set3,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'ALLPEN_XFERS')"
commuter rail IVT,cr_ivt_set3,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'ALLPEN_CMRIVTT')"
light rail IVT,lrt_ivt_set3,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'ALLPEN_LRTIVTT')"
bus rapid transit red IVT,brt_red_ivt_set3,"los.get_tappairs3d(df.btap,df.atap,df.tod,'ALLPEN_BRTREDIVTT')"
bus rapid transit yellow IVT,brt_yel_ivt_set3,"los.get_tappairs3d(df.btap,df.atap,df.tod,'ALLPEN_BRTYELIVTT')"
express bus IVT,eb_ivt_set3,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'ALLPEN_EXPIVTT')"
limited bus IVT,ltd_ivt_set3,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'ALLPEN_LTDEXPIVTT')"
local bus IVT,lb_ivt_set3,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'ALLPEN_BUSIVTT')"
first wait,first_wait_set3,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'ALLPEN_FIRSTWAIT')"
transfer wait,xfer_wait_set3,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'ALLPEN_XFERWAIT')"
total walk time,walk_time_set3,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'ALLPEN_TOTALWALK')"
fare,fare_set3,"los.get_tappairs3d(df.btap, df.atap, df.tod, 'ALLPEN_FARE')"
Transit avaiable,set3_available,"(total_ivt_set3 > 0) * (total_ivt_set3 < 99999) * (raw_transfers_set3 != 0)"
Number Transfers,transfers_set3,"np.clip(raw_transfers_set3, a_min=None, a_max=4)"
commuter rail ASC,asc_cr_set3,"set3_available * np.where(cr_ivt_set3 > 0, cr_asc * c_ivt, 0)"
light rail ASC,asc_lrt_set3,"set3_available * np.where(asc_cr_set3==0, np.where(lrt_ivt_set3 > 0, lrt_asc * c_ivt, 0), asc_cr_set3)"
bus rapid transit ASC,asc_brt_set3,"set3_available * np.where(asc_lrt_set3==0, np.where(brt_red_ivt_set3 + brt_yel_ivt_set3 > 0, brt_asc * c_ivt, 0), asc_lrt_set3)"
express bus ASC,asc_eb_set3,"set3_available * np.where(asc_brt_set3==0, np.where(eb_ivt_set3 + ltd_ivt_set3 > 0, exp_asc * c_ivt, 0), asc_brt_set3)"