

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CDAP &mdash; ActivitySim 0.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ActivitySim 0.1 documentation" href="index.html"/>
        <link rel="next" title="MNL Utilities" href="mnl.html"/>
        <link rel="prev" title="Skim Abstractions" href="skim.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> ActivitySim</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gettingstarted.html#installation">Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="core.html#module-activitysim.activitysim">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="skim.html">Skim Abstractions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="skim.html#module-activitysim.skim">API</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">CDAP</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-activitysim.cdap.cdap">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mnl.html">MNL Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mnl.html#module-activitysim.mnl">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="util.html">Internal Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="util.html#module-activitysim.util.reindex">Reindex</a></li>
<li class="toctree-l2"><a class="reference internal" href="util.html#module-activitysim.util.testing">Testing</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">ActivitySim</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>CDAP</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/cdap.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="cdap">
<h1>CDAP<a class="headerlink" href="#cdap" title="Permalink to this headline">¶</a></h1>
<p>The main interface to CDAP is the
<a class="reference internal" href="#activitysim.cdap.cdap.run_cdap" title="activitysim.cdap.cdap.run_cdap"><tt class="xref py py-func docutils literal"><span class="pre">run_cdap()</span></tt></a> function.</p>
<div class="section" id="module-activitysim.cdap.cdap">
<span id="api"></span><h2>API<a class="headerlink" href="#module-activitysim.cdap.cdap" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="activitysim.cdap.cdap.apply_all_people">
<tt class="descclassname">activitysim.cdap.cdap.</tt><tt class="descname">apply_all_people</tt><big>(</big><em>hh_util</em>, <em>all_people</em><big>)</big><a class="headerlink" href="#activitysim.cdap.cdap.apply_all_people" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply utility adjustments to household alternatives.</p>
<p>This modifies the <cite>hh_util</cite> data inplace.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>hh_util</strong> : dict of pandas.Series</p>
<blockquote>
<div><p>Keys will be household IDs and values will be Series
mapping alternative choices to their utility.</p>
</div></blockquote>
<p><strong>all_people</strong> : pandas.DataFrame</p>
<blockquote class="last">
<div><p>Adjustments to household alternatives, with alternatives in the
index and the adjustment values in the first column.
Index should be household alternatives in the form of tuples
containing individual alternatives, e.g.
(&#8216;Mandatory&#8217;, &#8216;Mandatory&#8217;, &#8216;Mandatory&#8217;), where &#8216;Mandatory&#8217; is
one of the alternatives available to individual household members.
Note that these may also be expressed as Python code to save space,
so the previous could also be written as (&#8216;Mandatory&#8217;,) * 3.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="activitysim.cdap.cdap.apply_final_rules">
<tt class="descclassname">activitysim.cdap.cdap.</tt><tt class="descname">apply_final_rules</tt><big>(</big><em>hh_util</em>, <em>people</em>, <em>hh_id_col</em>, <em>final_rules</em><big>)</big><a class="headerlink" href="#activitysim.cdap.cdap.apply_final_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Final rules can be used to set the utility values for certain
household alternatives. Often they are set to zero to reflect
the unavailability of certain alternatives to certain types of people.</p>
<p>This modifies the <cite>hh_util</cite> data inplace.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>hh_util</strong> : dict of pandas.Series</p>
<blockquote>
<div><p>Keys will be household IDs and values will be Series
mapping alternative choices to their utility.</p>
</div></blockquote>
<p><strong>people</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>DataFrame of individual people data.</p>
</div></blockquote>
<p><strong>hh_id_col</strong> : str</p>
<blockquote>
<div><p>Name of the column in <cite>people</cite> that has their household ID.</p>
</div></blockquote>
<p><strong>final_rules</strong> : pandas.DataFrame</p>
<blockquote class="last">
<div><p>This table must have an index of expressions that can be used
to filter the <cite>people</cite> table. It must have two columns:
the first must have the name of the alternative to which the rule
applies, and the second must have the value of the utility for that
alternative. The names of the columns is not important, but
the order is.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="activitysim.cdap.cdap.household_choices_to_people">
<tt class="descclassname">activitysim.cdap.cdap.</tt><tt class="descname">household_choices_to_people</tt><big>(</big><em>hh_choices</em>, <em>people</em><big>)</big><a class="headerlink" href="#activitysim.cdap.cdap.household_choices_to_people" title="Permalink to this definition">¶</a></dt>
<dd><p>Map household choices to people so that we know the activity pattern
for individuals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>hh_choices</strong> : pandas.Series</p>
<blockquote>
<div><p>Maps household ID to chosen alternative, where the alternative
is a tuple of individual utilities.</p>
</div></blockquote>
<p><strong>people</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>DataFrame of individual people data.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>choices</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Maps index of <cite>people</cite> to their activity pattern choice.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="activitysim.cdap.cdap.individual_utilities">
<tt class="descclassname">activitysim.cdap.cdap.</tt><tt class="descname">individual_utilities</tt><big>(</big><em>people</em>, <em>hh_id_col</em>, <em>p_type_col</em>, <em>one_spec</em>, <em>two_spec</em>, <em>three_spec</em><big>)</big><a class="headerlink" href="#activitysim.cdap.cdap.individual_utilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate CDAP utilities for all individuals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>people</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>DataFrame of individual people data.</p>
</div></blockquote>
<p><strong>hh_id_col</strong> : str</p>
<blockquote>
<div><p>Name of the column in <cite>people</cite> that has their household ID.</p>
</div></blockquote>
<p><strong>p_type_col</strong> : str</p>
<blockquote>
<div><p>Name of the column in <cite>people</cite> that contains the person type number.</p>
</div></blockquote>
<p><strong>one_spec</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>CDAP spec applied to individuals.</p>
</div></blockquote>
<p><strong>two_spec</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>CDAP spec applied to interactions between two people.</p>
</div></blockquote>
<p><strong>three_spec</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>CDAP spec applied to interactions between three people.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>utilities</strong> : pandas.DataFrame</p>
<blockquote class="last">
<div><p>Will have index of <cite>people</cite> and columns for each of the alternatives.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="activitysim.cdap.cdap.initial_household_utilities">
<tt class="descclassname">activitysim.cdap.cdap.</tt><tt class="descname">initial_household_utilities</tt><big>(</big><em>utilities</em>, <em>people</em>, <em>hh_id_col</em><big>)</big><a class="headerlink" href="#activitysim.cdap.cdap.initial_household_utilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Create initial household utilities by grouping and summing utilities
from individual household members.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>utilities</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Should have the index of <cite>people</cite> and columns for each alternative.</p>
</div></blockquote>
<p><strong>people</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>DataFrame of individual people data.</p>
</div></blockquote>
<p><strong>hh_id_col</strong> : str</p>
<blockquote>
<div><p>Name of the column in <cite>people</cite> that has their household ID.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>hh_util</strong> : dict of pandas.Series</p>
<blockquote class="last">
<div><p>Keys will be household IDs and values will be Series
mapping alternative choices to their utility.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="activitysim.cdap.cdap.make_household_choices">
<tt class="descclassname">activitysim.cdap.cdap.</tt><tt class="descname">make_household_choices</tt><big>(</big><em>hh_util</em><big>)</big><a class="headerlink" href="#activitysim.cdap.cdap.make_household_choices" title="Permalink to this definition">¶</a></dt>
<dd><p>Decide on the activity pattern for each household.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>hh_util</strong> : dict of pandas.Series</p>
<blockquote>
<div><p>Keys will be household IDs and values will be Series
mapping alternative choices to their utility.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>choices</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Maps household ID to chosen alternative, where the alternative
is a tuple of individual utilities.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="activitysim.cdap.cdap.make_interactions">
<tt class="descclassname">activitysim.cdap.cdap.</tt><tt class="descname">make_interactions</tt><big>(</big><em>people</em>, <em>hh_id_col</em>, <em>p_type_col</em><big>)</big><a class="headerlink" href="#activitysim.cdap.cdap.make_interactions" title="Permalink to this definition">¶</a></dt>
<dd><p>Make two Pandas DataFrames associating people IDs with two
and three person interactions they have within their households.</p>
<p>Interactions are strings of numbers representing the makeup
of the interaction, e.g. &#8216;12&#8217; or &#8216;341&#8217;.</p>
<p>Note that for two-person interactions the interaction string is ordered
with the person from the index in the first position of the string
and some other person in the second position. In contrast,
the interaction strings for three-person interactions are not ordered.
The person from the index may be in any position of the string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>people</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table of people data. Must contain at least a household ID
column and a categorization of person type.</p>
</div></blockquote>
<p><strong>hh_id_col</strong> : str</p>
<blockquote>
<div><p>Name of the column in <cite>people</cite> that has their household ID.</p>
</div></blockquote>
<p><strong>p_type_col</strong> : str</p>
<blockquote>
<div><p>Name of the column in <cite>people</cite> that contains the person type number.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>two_interaction</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Interactions between two people. Index will be person IDs taken
from the index of <cite>people</cite>.
The table will have one column called <cite>interaction</cite>.</p>
</div></blockquote>
<p><strong>three_interaction</strong> : pandas.DataFrame</p>
<blockquote class="last">
<div><p>Interactions between three people. Index will be person IDs taken
from the index of <cite>people</cite>.
The table will have one column called <cite>interaction</cite>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="activitysim.cdap.cdap.run_cdap">
<tt class="descclassname">activitysim.cdap.cdap.</tt><tt class="descname">run_cdap</tt><big>(</big><em>people</em>, <em>hh_id_col</em>, <em>p_type_col</em>, <em>one_spec</em>, <em>two_spec</em>, <em>three_spec</em>, <em>final_rules</em>, <em>all_people</em><big>)</big><a class="headerlink" href="#activitysim.cdap.cdap.run_cdap" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose individual activity patterns for people.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>people</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table of people data. Must contain at least a household ID
column and a categorization of person type.</p>
</div></blockquote>
<p><strong>hh_id_col</strong> : str</p>
<blockquote>
<div><p>Name of the column in <cite>people</cite> that has their household ID.</p>
</div></blockquote>
<p><strong>p_type_col</strong> : str</p>
<blockquote>
<div><p>Name of the column in <cite>people</cite> that contains the person type number.</p>
</div></blockquote>
<p><strong>one_spec</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>CDAP spec applied to individuals.</p>
</div></blockquote>
<p><strong>two_spec</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>CDAP spec applied to interactions between two people.</p>
</div></blockquote>
<p><strong>three_spec</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>CDAP spec applied to interactions between three people.</p>
</div></blockquote>
<p><strong>final_rules</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>This table must have an index of expressions that can be used
to filter the <cite>people</cite> table. It must have two columns:
the first must have the name of the alternative to which the rule
applies, and the second must have the value of the utility for that
alternative. The names of the columns is not important, but
the order is.</p>
</div></blockquote>
<p><strong>all_people</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Adjustments to household alternatives, with alternatives in the
index and the adjustment values in the first column.
Index should be household alternatives in the form of tuples
containing individual alternatives, e.g.
(&#8216;Mandatory&#8217;, &#8216;Mandatory&#8217;, &#8216;Mandatory&#8217;), where &#8216;Mandatory&#8217; is
one of the alternatives available to individual household members.
Note that these may also be expressed as Python code to save space,
so the previous could also be written as (&#8216;Mandatory&#8217;,) * 3.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>choices</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Maps index of <cite>people</cite> to their activity pattern choice,
where that choice is taken from the columns of specs
(so it&#8217;s important that the specs all refer to alternatives
in the same way).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mnl.html" class="btn btn-neutral float-right" title="MNL Utilities">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="skim.html" class="btn btn-neutral" title="Skim Abstractions"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Autodesk.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>