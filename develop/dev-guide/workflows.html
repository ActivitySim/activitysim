
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Workflows &#8212; ActivitySim 1.1.4.dev511+g71d3e919</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Software Development" href="../development.html" />
    <link rel="prev" title="Using Skim Dataset" href="skim-dataset.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">ActivitySim</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../users-guide/index.html">
  Users Guide
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Developers
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        1.1.4  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables dev-guide/workflows and {'json_url': 'https://activitysim.github.io/activitysim/switcher.json', 'version_match': '1.1.4'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "dev-guide/workflows.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://activitysim.github.io/activitysim/switcher.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "dev-guide/workflows.html";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 1.1.4 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "1.1.4") {
                node.classList.add("active");
                let btn = document.getElementById("version_switcher_button");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="install.html">
   Developer Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="using-sharrow.html">
   Using Sharrow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="skim-dataset.html">
   Using Skim Dataset
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Workflows
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../development.html">
   Software Development
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../models.html">
   Models
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="components/index.html">
   Components
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="components/trip_destination.html">
     Trip Destination
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../core.html">
   Core Components
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../benchmarking.html">
   Benchmarking
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#workflows-for-performance-monitoring">
   Workflows for Performance Monitoring
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mini-examples">
     Mini Examples
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#full-size-examples">
     Full Size Examples
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="workflows">
<span id="id1"></span><h1>Workflows<a class="headerlink" href="#workflows" title="Permalink to this headline">#</a></h1>
<p>ActivitySim workflows use the <a class="reference external" href="https://pypyr.io/"><code class="docutils literal notranslate"><span class="pre">pypyr</span></code></a> library. This
task runner is more flexible than orca, and relies on isolated ‘context’
namespaces rather than storing tables and configurations in Python’s
global state. Workflows are activated using the <code class="docutils literal notranslate"><span class="pre">activitysim</span> <span class="pre">workflow</span></code>
command line interface.</p>
<p>You can run a workflow from a local working directory, or one of
a number of pre-packaged workflows that are included with ActivitySim.</p>
<section id="workflows-for-performance-monitoring">
<h2>Workflows for Performance Monitoring<a class="headerlink" href="#workflows-for-performance-monitoring" title="Permalink to this headline">#</a></h2>
<p>A collection of workflows used to compare the new <em>sharrow</em> code against
legacy implementations can be found in the
<a class="reference external" href="https://github.com/camsys/activitysim/tree/sharrow-black/activitysim/workflows/sharrow-contrast">sharrow-contrast</a>
workflow subdirectory. Each of these first runs the relevant example model in
test mode to compile the relevant functions, and then runs in production mode
to measure runtime and memory usage.  This is followed by another run in
“legacy” mode that does not use sharrow, as well as a run in a reference
implementation (version 1.1.3).  Finally, a report is generated comparing the
results of these various runs, to illustrate performance and validiate output
quality.</p>
<section id="mini-examples">
<h3>Mini Examples<a class="headerlink" href="#mini-examples" title="Permalink to this headline">#</a></h3>
<p>A collection of “mini” example workflows is provided for typical performance analysis.
Each mini example is based on a small or medium size subarea for each model,
and each runs in single-process mode to illustrate the performance and memory
usage succinctly.  These mini examples are sized so they should run on a typical
modeler’s laptop (e.g. a modern CPU, 32 GB of RAM).</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Workflow</p></th>
<th class="text-align:left head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>mtc_mini</p></td>
<td class="text-align:left"><p>Prototype MTC model on 50K households in San Francisco (190 zones)</p></td>
</tr>
<tr class="row-odd"><td><p>arc_mini</p></td>
<td class="text-align:left"><p>Prototype ARC model on 10K households in Fulton County (1,296 zones)</p></td>
</tr>
<tr class="row-even"><td><p>sandag_1zone_mini</p></td>
<td class="text-align:left"><p>Placeholder SANDAG 1-Zone model on 50K households in a test region (90 zones)</p></td>
</tr>
<tr class="row-odd"><td><p>sandag_2zone_mini</p></td>
<td class="text-align:left"><p>Placeholder SANDAG 2-Zone model on 50K households in a test region (90 TAZs, 690 MAZs)</p></td>
</tr>
<tr class="row-even"><td><p>sandag_3zone_mini</p></td>
<td class="text-align:left"><p>Placeholder SANDAG 3-Zone model on 50K households in a test region (90 TAZs, 690 MAZs)</p></td>
</tr>
<tr class="row-odd"><td><p>sandag_xborder_mini</p></td>
<td class="text-align:left"><p>Prototype SANDAG Cross-Border model on 50K tours in a test region (94 TAZs, 586 MAZs)</p></td>
</tr>
<tr class="row-even"><td><p>psrc_mini</p></td>
<td class="text-align:left"><p>Placeholder PSRC Model on 50K households in Seattle (8400 MAZs)</p></td>
</tr>
<tr class="row-odd"><td><p>comprehensive-mini</p></td>
<td class="text-align:left"><p>Runs all “mini” workflows listed above (warning, this takes a long time!)</p></td>
</tr>
</tbody>
</table>
<p>To invoke a pre-packaged workflow, you can provide the workflow’s
name and location within the <code class="docutils literal notranslate"><span class="pre">activitysim/workflows</span></code> directory.
For example, to run the workflow of all “mini” examples, run:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>activitysim<span class="w"> </span>workflow<span class="w"> </span>sharrow-contrast/comprehensive-mini
</pre></div>
</div>
</section>
<section id="full-size-examples">
<h3>Full Size Examples<a class="headerlink" href="#full-size-examples" title="Permalink to this headline">#</a></h3>
<p>Running a “full size” example of an ActivitySim model generally requires more
compute resources than the smaller performance tests shown above.  These models
generally require <a class="reference internal" href="../core.html#chunk-size"><span class="std std-ref">chunking</span></a> to run, and servers with substantial
amounts of RAM.</p>
<p>The “mp” workflows listed below will run each listed example in multiprocess mode.
They will attempt to automatically scale the number of processes and the chunk
size to the available resources of the server where they are run, but some models
require substantial resources and may not run correctly on inadequate hardware.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Workflow</p></th>
<th class="text-align:left head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>mtc_mp</p></td>
<td class="text-align:left"><p>Prototype MTC model</p></td>
</tr>
<tr class="row-odd"><td><p>arc_mp</p></td>
<td class="text-align:left"><p>Prototype ARC model, 5,922 zones</p></td>
</tr>
<tr class="row-even"><td><p>sandag_1zone_mp</p></td>
<td class="text-align:left"><p>Placeholder SANDAG 1-Zone model, 1.2M households and 4,984 zones</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="skim-dataset.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Using Skim Dataset</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../development.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Software Development</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <!-- This will display the version of the docs -->
<p class="last-updated">
ActivitySim 1.1.4.dev511+g71d3e919, documentation last updated Jan 03, 2023.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>