

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Models &#8212; ActivitySim 1.2.2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'models';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.14.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://activitysim.github.io/activitysim/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.2.2';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Components" href="dev-guide/components/index.html" />
    <link rel="prev" title="Software Development" href="development.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Dec 02, 2023"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">ActivitySim 1.2.2</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="users-guide/index.html">
                        Users Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="dev-guide/index.html">
                        Developers
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="users-guide/index.html">
                        Users Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="dev-guide/index.html">
                        Developers
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="dev-guide/install.html">Developer Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-guide/using-sharrow.html">Using Sharrow</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-guide/skim-dataset.html">Using Skim Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-guide/workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Software Development</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dev-guide/components/index.html">Components</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="dev-guide/components/trip_destination.html">Trip Destination</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmarking.html">Benchmarking</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="dev-guide/index.html" class="nav-link">Developers</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Models</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="models">
<span id="index-0"></span><span id="id1"></span><h1>Models<a class="headerlink" href="#models" title="Permalink to this heading">#</a></h1>
<p>The currently implemented example ActivitySim AB models are described below.  See the example
model <a class="reference internal" href="examples.html#sub-model-spec-files"><span class="std std-ref">Sub-Model Specification Files</span></a>, <a class="reference internal" href="examples.html#arc-sub-model-spec-files"><span class="std std-ref">Example ARC Sub-Model Specification Files</span></a>, and <a class="reference internal" href="examples.html#semcog-sub-model-spec-files"><span class="std std-ref">Example SEMCOG Sub-Model Specification Files</span></a> for more information.</p>
<section id="initialize">
<span id="initialize-tours"></span><span id="initialize-households"></span><span id="initialize-landuse"></span><h2>Initialize<a class="headerlink" href="#initialize" title="Permalink to this heading">#</a></h2>
<p>The initialize model isn’t really a model, but rather a few data processing steps in the data pipeline.
The initialize data processing steps code variables used in downstream models, such as household and person
value-of-time.  This step also pre-loads the land_use, households, persons, and person_windows tables because
random seeds are set differently for each step and therefore the sampling of households depends on which step
they are initially loaded in.</p>
<p>The main interface to the initialize land use step is the <code class="xref py py-func docutils literal notranslate"><span class="pre">initialize_landuse()</span></code>
function. The main interface to the initialize household step is the <code class="xref py py-func docutils literal notranslate"><span class="pre">initialize_households()</span></code>
function.  The main interface to the initialize tours step is the <code class="xref py py-func docutils literal notranslate"><span class="pre">initialize_tours()</span></code>
function.  These functions are registered as Inject steps in the example Pipeline.</p>
</section>
<section id="initialize-tvpb">
<span id="initialize-los"></span><span id="id2"></span><h2>Initialize LOS<a class="headerlink" href="#initialize-tvpb" title="Permalink to this heading">#</a></h2>
<p>The initialize LOS model isn’t really a model, but rather a series of data processing steps in the data pipeline.
The initialize LOS model does two things:</p>
<blockquote>
<div><ul class="simple">
<li><p>Loads skims and cache for later if desired</p></li>
<li><p>Loads network LOS inputs for transit virtual path building (see <a class="reference internal" href="core.html#transit-virtual-path-builder"><span class="std std-ref">Transit Virtual Path Builder</span></a>), pre-computes tap-to-tap total utilities and cache for later if desired</p></li>
</ul>
</div></blockquote>
<p>The main interface to the initialize LOS step is the <code class="xref py py-func docutils literal notranslate"><span class="pre">initialize_los()</span></code>
function.  The main interface to the initialize TVPB step is the <code class="xref py py-func docutils literal notranslate"><span class="pre">initialize_tvpb()</span></code>
function.  These functions are registered as Inject steps in the example Pipeline.</p>
</section>
<section id="accessibility">
<span id="id3"></span><h2>Accessibility<a class="headerlink" href="#accessibility" title="Permalink to this heading">#</a></h2>
<p>The accessibilities model is an aggregate model that calculates multiple origin-based accessibility
measures by origin zone to all destination zones.</p>
<p>The accessibility measure first multiplies an employment variable by a mode-specific decay function.  The
product reflects the difficulty of accessing the activities the farther (in terms of round-trip travel time)
the jobs are from the location in question. The products to each destination zone are next summed over
each origin zone, and the logarithm of the product mutes large differences.  The decay function on
the walk accessibility measure is steeper than automobile or transit.  The minimum accessibility is zero.</p>
<p>Level-of-service variables from three time periods are used, specifically the AM peak period (6 am to 10 am), the
midday period (10 am to 3 pm), and the PM peak period (3 pm to 7 pm).</p>
<p><em>Inputs</em></p>
<ul class="simple">
<li><p>Highway skims for the three periods.  Each skim is expected to include a table named “TOLLTIMEDA”, which is the drive alone in-vehicle travel time for automobiles willing to pay a “value” (time-savings) toll.</p></li>
<li><p>Transit skims for the three periods.  Each skim is expected to include the following tables: (i) “IVT”, in-vehicle time; (ii) “IWAIT”, initial wait time; (iii) “XWAIT”, transfer wait time; (iv) “WACC”, walk access time; (v) “WAUX”, auxiliary walk time; and, (vi) “WEGR”, walk egress time.</p></li>
<li><p>Zonal data with the following fields: (i) “TOTEMP”, total employment; (ii) “RETEMPN”, retail trade employment per the NAICS classification.</p></li>
</ul>
<p><em>Outputs</em></p>
<ul class="simple">
<li><p>taz, travel analysis zone number</p></li>
<li><p>autoPeakRetail, the accessibility by automobile during peak conditions to retail employment for this TAZ</p></li>
<li><p>autoPeakTotal, the accessibility by automobile during peak conditions to all employment</p></li>
<li><p>autoOffPeakRetail, the accessibility by automobile during off-peak conditions to retail employment</p></li>
<li><p>autoOffPeakTotal, the accessibility by automobile during off-peak conditions to all employment</p></li>
<li><p>transitPeakRetail, the accessibility by transit during peak conditions to retail employment</p></li>
<li><p>transitPeakTotal, the accessibility by transit during peak conditions to all employment</p></li>
<li><p>transitOffPeakRetail, the accessiblity by transit during off-peak conditions to retail employment</p></li>
<li><p>transitOffPeakTotal, the accessiblity by transit during off-peak conditions to all employment</p></li>
<li><p>nonMotorizedRetail, the accessibility by walking during all time periods to retail employment</p></li>
<li><p>nonMotorizedTotal, the accessibility by walking during all time periods to all employment</p></li>
</ul>
<p>The main interface to the accessibility model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">compute_accessibility()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">skims</span></code> | Result Table: <code class="docutils literal notranslate"><span class="pre">accessibility</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">O-D,</span> <span class="pre">D-O</span></code></p>
</section>
<section id="disaggregate-accessibility">
<span id="id4"></span><h2>Disaggregate Accessibility<a class="headerlink" href="#disaggregate-accessibility" title="Permalink to this heading">#</a></h2>
<p>The disaggregate accessibility model is an extension of the base accessibility model.
While the base accessibility model is based on a mode-specific decay function and uses fixed market
segments in the population (i.e., income), the disaggregate accessibility model extracts the actual
destination choice logsums by purpose (i.e., mandatory fixed school/work location and non-mandatory
tour destinations by purpose) from the actual model calculations using a user-defined proto-population.
This enables users to include features that may be more critical to destination
choice than just income (e.g., automobile ownership).</p>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p>disaggregate_accessibility.yaml - Configuration settings for disaggregate accessibility model.</p></li>
<li><p>annotate.csv [optional] - Users can specify additional annotations specific to disaggregate accessibility. For example, annotating the proto-population tables.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><ul class="simple">
<li><p>final_disaggregate_accessibility.csv [optional]</p></li>
<li><p>final_non_mandatory_tour_destination_accesibility.csv [optional]</p></li>
<li><p>final_workplace_location_accessibility.csv [optional]</p></li>
<li><p>final_school_location_accessibility.csv [optional]</p></li>
<li><p>final_proto_persons.csv [optional]</p></li>
<li><p>final_proto_households.csv [optional]</p></li>
<li><p>final_proto_tours.csv [optional]</p></li>
</ul>
</dd>
</dl>
<p>The above tables are created in the model pipeline, but the model will not save
any outputs unless specified in settings.yaml - output_tables. Users can return
the proto population tables for inspection, as well as the raw logsum accessibilities
for mandatory school/work and non-mandatory destinations. The logsums are then merged
at the household level in final_disaggregate_accessibility.csv, which each tour purpose
logsums shown as separate columns.</p>
<p><strong>Usage</strong>
The disaggregate accessibility model is run as a model step in the model list.
There are two necessary steps:</p>
<p><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">initialize_proto_population</span></code> | <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">compute_disaggregate_accessibility</span></code></p>
<p>The reason the steps must be separate is to enable multiprocessing.
The proto-population must be fully generated and initialized before activitysim
slices the tables into separate threads. These steps must also occur before
initialize_households in order to avoid conflict with the shadow_pricing model.</p>
<p>The model steps can be run either as part the activitysim model run, or setup
to run as a standalone run to pre-computing the accessibility values.
For standalone implementations, the final_disaggregate_accessibility.csv is read
into the pipeline and initialized with the initialize_household model step.</p>
<dl class="simple">
<dt><strong>Configuration of disaggregate_accessibility.yaml:</strong></dt><dd><ul class="simple">
<li><p>CREATE_TABLES - Users define the variables to be generated for PROTO_HOUSEHOLDS, PROTO_PERSONS, and PROTO_TOURS tables. These tables must include all basic fields necessary for running the actual model. Additional fields can be annotated in pre-processing using the annotation settings of this file. The base variables in each table are defined using the following parameters:</p>
<ul>
<li><p>VARIABLES - The base variable, must be a value or a list. Results in the cartesian product (all non-repeating combinations) of the fields.</p></li>
<li><p>mapped_fields [optional] - For non-combinatorial fields, users can map a variable to the fields generated in VARIABLES (e.g., income category bins mapped to median dollar values).</p></li>
<li><p>filter_rows [optional] - Users can also filter rows using pandas expressions if specific variable combinations are not desired.</p></li>
<li><p>JOIN_ON [required only for PROTO_TOURS] - specify the persons variable to join the tours to (e.g., person_number).</p></li>
</ul>
</li>
<li><p>MERGE_ON - User specified fields to merge the proto-population logsums onto the full synthetic population. The proto-population should be designed such that the logsums are able to be joined exactly on these variables specified to the full population. Users specify the to join on using:</p>
<ul>
<li><p>by: An exact merge will be attempted using these discrete variables.</p></li>
<li><p>asof [optional]: The model can peform an “asof” join for continuous variables, which finds the nearest value. This method should not be necessary since synthetic populations are all discrete.</p></li>
<li><p>method [optional]: Optional join method can be “soft”, default is None. For cases where a full inner join is not possible, a Naive Bayes clustering method is fast but discretely constrained method. The proto-population is treated as the “training data” to match the synthetic population value to the best possible proto-population candidate. The Some refinement may be necessary to make this procedure work.</p></li>
</ul>
</li>
<li><p>annotate_proto_tables [optional] - Annotation configurations if users which to modify the proto-population beyond basic generation in the YAML.</p></li>
<li><p>DESTINATION_SAMPLE_SIZE - The <em>destination</em> sample size (0 = all zones), e.g., the number of destination zone alternatives sampled for calculating the destination logsum. Decimal values &lt; 1 will be interpreted as a percentage, e.g., 0.5 = 50% sample.</p></li>
<li><p>ORIGIN_SAMPLE_SIZE - The <em>origin</em> sample size (0 = all zones), e.g., the number of origins where logsum is calculated. Origins without a logsum will draw from the nearest zone with a logsum. This parameter is useful for systems with a large number of zones with similar accessibility. Decimal values &lt; 1 will be interpreted as a percentage, e.g., 0.5 = 50% sample.</p></li>
<li><p>ORIGIN_SAMPLE_METHOD - The method in which origins are sampled. Population weighted sampling can be TAZ-based or “TAZ-agnostic” using KMeans clustering. The potential advantage of KMeans is to provide a more geographically even spread of MAZs sampled that do not rely on TAZ hierarchies. Unweighted sampling is also possible using ‘uniform’ and ‘uniform-taz’.</p>
<ul>
<li><p>None [Default] - Sample zones weighted by population, ensuring at least one TAZ is sampled per MAZ. If n-samples &gt; n-tazs then sample 1 MAZ from each TAZ until n-remaining-samples &lt; n-tazs, then sample n-remaining-samples TAZs and sample an MAZ within each of those TAZs. If n-samples &lt; n-tazs, then it proceeds to the above ‘then’ condition.</p></li>
<li><p>“kmeans” - K-Means clustering is performed on the zone centroids (must be provided as maz_centroids.csv), weighted by population. The clustering yields k XY coordinates weighted by zone population for n-samples = k-clusters specified. Once k new cluster centroids are found, these are then approximated into the nearest available zone centroid and used to calculate accessibilities on. By default, the k-means method is run on 10 different initial cluster seeds (n_init) using using “k-means++” seeding algorithm (<a class="reference external" href="https://en.wikipedia.org/wiki/K-means%2B%2B">https://en.wikipedia.org/wiki/K-means%2B%2B</a>). The k-means method runs for max_iter iterations (default=300).</p></li>
<li><p>“uniform” - Unweighted sample of N zones independent of each other.</p></li>
<li><p>“uniform-taz” - Unweighted sample of 1 zone per taz up to the N samples specified.</p></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
<section id="work-from-home">
<span id="id5"></span><h2>Work From Home<a class="headerlink" href="#work-from-home" title="Permalink to this heading">#</a></h2>
<p>Telecommuting is defined as workers who work from home instead of going
to work. It only applies to workers with a regular workplace outside of home.
The telecommute model consists of two submodels - this work from home model and a
person <a class="reference internal" href="#telecommute-frequency"><span class="std std-ref">Telecommute Frequency</span></a> model. This model predicts for all workers whether they
usually work from home.</p>
<p>The work from home model includes the ability to adjust a work from home alternative
constant to attempt to realize a work from home percent for what-if type analysis.
This iterative single process procedure takes as input a number of iterations, a filter on
the choosers to use for the calculation, a target work from home percent, a tolerance percent
for convergence, and the name of the coefficient to adjust.  An example setup is provided and
the coefficient adjustment at each iteration is:
<code class="docutils literal notranslate"><span class="pre">new_coefficient</span> <span class="pre">=</span> <span class="pre">log(</span> <span class="pre">target_percent</span> <span class="pre">/</span> <span class="pre">current_percent</span> <span class="pre">)</span> <span class="pre">+</span> <span class="pre">current_coefficient</span></code>.</p>
<p>The main interface to the work from home model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">work_from_home()</span></code> function.  This
function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">persons</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">work_from_home</span></code> | Skims Keys: NA</p>
</section>
<section id="work-location">
<span id="school-location"></span><span id="id6"></span><h2>School Location<a class="headerlink" href="#work-location" title="Permalink to this heading">#</a></h2>
<p>The usual school location choice models assign a usual school location for the primary
mandatory activity of each child and university student in the
synthetic population. The models are composed of a set of accessibility-based parameters
(including one-way distance between home and primary destination and the tour mode choice
logsum - the expected maximum utility in the mode choice model which is given by the
logarithm of the sum of exponentials in the denominator of the logit formula) and size terms,
which describe the quantity of grade-school or university opportunities in each possible
destination.</p>
<dl class="simple">
<dt>The school location model is made up of four steps:</dt><dd><ul class="simple">
<li><p>sampling - selects a sample of alternative school locations for the next model step. This selects X locations from the full set of model zones using a simple utility.</p></li>
<li><p>logsums - starts with the table created above and calculates and adds the mode choice logsum expression for each alternative school location.</p></li>
<li><p>simulate - starts with the table created above and chooses a final school location, this time with the mode choice logsum included.</p></li>
<li><p>shadow prices - compare modeled zonal destinations to target zonal size terms and calculate updated shadow prices.</p></li>
</ul>
</dd>
</dl>
<p>These steps are repeated until shadow pricing convergence criteria are satisfied or a max number of iterations is reached.  See <a class="reference internal" href="#shadow-pricing"><span class="std std-ref">Shadow Pricing</span></a>.</p>
<p>School location choice for <a class="reference internal" href="examples.html#multiple-zone-systems"><span class="std std-ref">placeholder_multiple_zone</span></a> models uses <a class="reference internal" href="examples.html#presampling"><span class="std std-ref">Presampling</span></a> by default.</p>
<p>The main interfaces to the model is the <code class="xref py py-func docutils literal notranslate"><span class="pre">school_location()</span></code> function.
This function is registered as an Inject step in the example Pipeline.  See <a class="reference internal" href="examples.html#writing-logsums"><span class="std std-ref">Writing Logsums</span></a> for how to write logsums for estimation.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">persons</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">school_taz</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">TAZ,</span> <span class="pre">alt_dest,</span> <span class="pre">AM</span> <span class="pre">time</span> <span class="pre">period,</span> <span class="pre">MD</span> <span class="pre">time</span> <span class="pre">period</span></code></p>
</section>
<section id="id7">
<h2>Work Location<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h2>
<p>The usual work location choice models assign a usual work location for the primary
mandatory activity of each employed person in the
synthetic population. The models are composed of a set of accessibility-based parameters
(including one-way distance between home and primary destination and the tour mode choice
logsum - the expected maximum utility in the mode choice model which is given by the
logarithm of the sum of exponentials in the denominator of the logit formula) and size terms,
which describe the quantity of work opportunities in each possible destination.</p>
<dl class="simple">
<dt>The work location model is made up of four steps:</dt><dd><ul class="simple">
<li><p>sample - selects a sample of alternative work locations for the next model step. This selects X locations from the full set of model zones using a simple utility.</p></li>
<li><p>logsums - starts with the table created above and calculates and adds the mode choice logsum expression for each alternative work location.</p></li>
<li><p>simulate - starts with the table created above and chooses a final work location, this time with the mode choice logsum included.</p></li>
<li><p>shadow prices - compare modeled zonal destinations to target zonal size terms and calculate updated shadow prices.</p></li>
</ul>
</dd>
</dl>
<p>These steps are repeated until shadow pricing convergence criteria are satisfied or a max number of iterations is reached.  See <a class="reference internal" href="#shadow-pricing"><span class="std std-ref">Shadow Pricing</span></a>.</p>
<p>Work location choice for <a class="reference internal" href="examples.html#multiple-zone-systems"><span class="std std-ref">placeholder_multiple_zone</span></a> models uses <a class="reference internal" href="examples.html#presampling"><span class="std std-ref">Presampling</span></a> by default.</p>
<p>The main interfaces to the model is the <code class="xref py py-func docutils literal notranslate"><span class="pre">workplace_location()</span></code> function.
This function is registered as an Inject step in the example Pipeline.  See <a class="reference internal" href="examples.html#writing-logsums"><span class="std std-ref">Writing Logsums</span></a> for how to write logsums for estimation.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">persons</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">workplace_taz</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">TAZ,</span> <span class="pre">alt_dest,</span> <span class="pre">AM</span> <span class="pre">time</span> <span class="pre">period,</span> <span class="pre">PM</span> <span class="pre">time</span> <span class="pre">period</span></code></p>
</section>
<section id="shadow-pricing">
<span id="index-1"></span><span id="id8"></span><h2>Shadow Pricing<a class="headerlink" href="#shadow-pricing" title="Permalink to this heading">#</a></h2>
<p>The shadow pricing calculator used by work and school location choice.</p>
<p><strong>Turning on and saving shadow prices</strong></p>
<p>Shadow pricing is activated by setting the <code class="docutils literal notranslate"><span class="pre">use_shadow_pricing</span></code> to True in the settings.yaml file.
Once this setting has been activated, ActivitySim will search for shadow pricing configuration in
the shadow_pricing.yaml file. When shadow pricing is activated, the shadow pricing outputs will be
exported by the tracing engine. As a result, the shadow pricing output files will be prepended with
<code class="docutils literal notranslate"><span class="pre">trace</span></code> followed by the iteration number the results represent. For example, the shadow pricing
outputs for iteration 3 of the school location model will be called
<code class="docutils literal notranslate"><span class="pre">trace.shadow_price_school_shadow_prices_3.csv</span></code>.</p>
<p>In total, ActivitySim generates three types of output files for each model with shadow pricing:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trace.shadow_price_&lt;model&gt;_desired_size.csv</span></code> The size terms by zone that the ctramp and daysim
methods are attempting to target. These equal the size term columns in the land use data
multiplied by size term coefficients.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trace.shadow_price_&lt;model&gt;_modeled_size_&lt;iteration&gt;.csv</span></code> These are the modeled size terms after
the iteration of shadow pricing identified by the &lt;iteration&gt; number. In other words, these are
the predicted choices by zone and segment for the model after the iteration completes. (Not
applicable for <code class="docutils literal notranslate"><span class="pre">simulation</span></code> option.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trace.shadow_price_&lt;model&gt;_shadow_prices_&lt;iteration&gt;.csv</span></code> The actual shadow price for each zone
and segment after the &lt;iteration&gt; of shadow pricing. This is the file that can be used to warm
start the shadow pricing mechanism in ActivitySim. (Not applicable for <code class="docutils literal notranslate"><span class="pre">simulation</span></code> option.)</p></li>
</ul>
<p>There are three shadow pricing methods in activitysim: <code class="docutils literal notranslate"><span class="pre">ctramp</span></code>, <code class="docutils literal notranslate"><span class="pre">daysim</span></code>, and <code class="docutils literal notranslate"><span class="pre">simulation</span></code>.
The first two methods try to match model output with workplace/school location model size terms,
while the last method matches model output with actual employment/enrollmment data.</p>
<p>The simulation approach operates the following steps.  First, every worker / student will be
assigned without shadow prices applied. The modeled share and the target share for each zone are
compared. If the zone is overassigned, a sample of people from the over-assigned zones will be
selected for re-simulation.  Shadow prices are set to -999 for the next iteration for overassigned
zones which removes the zone from the set of alternatives in the next iteration. The sampled people
will then be forced to choose from one of the under-assigned zones that still have the initial
shadow price of 0. (In this approach, the shadow price variable is really just a switch turning that
zone on or off for selection in the subsequent iterations. For this reason, warm-start functionality
for this approach is not applicable.)  This process repeats until the overall convergence criteria
is met or the maximum number of allowed iterations is reached.</p>
<p>Because the simulation approach only re-simulates workers / students who were over-assigned in the
previous iteration, run time is significantly less (~90%) than the CTRAMP or DaySim approaches which
re-simulate all workers and students at each iteration.</p>
<p><strong>shadow_pricing.yaml Attributes</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">shadow_pricing_models</span></code> List model_selectors and model_names of models that use shadow pricing.
This list identifies which size_terms to preload which must be done in single process mode, so
predicted_size tables can be scaled to population</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LOAD_SAVED_SHADOW_PRICES</span></code> global switch to enable/disable loading of saved shadow prices. From
the above example, this would be trace.shadow_price_&lt;model&gt;_shadow_prices_&lt;iteration&gt;.csv renamed
and stored in the <code class="docutils literal notranslate"><span class="pre">data_dir</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MAX_ITERATIONS</span></code> If no loaded shadow prices, maximum number of times shadow pricing can be run
on each model before proceeding to the next model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MAX_ITERATIONS_SAVED</span></code> If loaded shadow prices, maximum number of times shadow pricing can be
run.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SIZE_THRESHOLD</span></code> Ignore zones in failure calculation (ctramp or daysim method) with smaller size
term value than size_threshold.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TARGET_THRESHOLD</span></code> Ignore zones in failure calculation (simulation method) with smaller
employment/enrollment than target_threshold.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PERCENT_TOLERANCE</span></code> Maximum percent difference between modeled and desired size terms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAIL_THRESHOLD</span></code> percentage of zones exceeding the PERCENT_TOLERANCE considered a failure</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SHADOW_PRICE_METHOD</span></code> [ctramp | daysim | simulation]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">workplace_segmentation_targets</span></code> dict matching school segment to landuse employment column
target. Only used as part of simulation option. If mutiple segments list the same target column,
the segments will be added together for comparison. (Same with the school option below.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">school_segmentation_targets</span></code> dict matching school segment to landuse enrollment column target.
Only used as part of simulation option.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DAMPING_FACTOR</span></code> On each iteration, ActivitySim will attempt to adjust the model to match
desired size terms. The number is multiplied by adjustment factor to dampen or amplify the
ActivitySim calculation. (only for CTRAMP)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DAYSIM_ABSOLUTE_TOLERANCE</span></code> Absolute tolerance for DaySim option</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DAYSIM_PERCENT_TOLERANCE</span></code> Relative tolerance for DaySim option</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WRITE_ITERATION_CHOICES</span></code> [True | False ] Writes the choices of each person out to the trace
folder. Used for debugging or checking itration convergence. WARNING: every person is written for
each sub-process so the disc space can get large.</p></li>
</ul>
</section>
<section id="transit-pass-subsidy">
<span id="id9"></span><h2>Transit Pass Subsidy<a class="headerlink" href="#transit-pass-subsidy" title="Permalink to this heading">#</a></h2>
<p>The transit fare discount model is defined as persons who purchase or are
provided a transit pass.  The transit fare discount consists of two submodels - this
transit pass subsidy model and a person <a class="reference internal" href="#transit-pass-ownership"><span class="std std-ref">Transit Pass Ownership</span></a> model.  The
result of this model can be used to condition downstream models such as the
person <a class="reference internal" href="#transit-pass-ownership"><span class="std std-ref">Transit Pass Ownership</span></a> model and the tour and trip mode choice models
via fare discount adjustments.</p>
<p>The main interface to the transit pass subsidy model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">transit_pass_subsidy()</span></code> function.  This
function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">persons</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">transit_pass_subsidy</span></code> | Skims Keys: NA</p>
</section>
<section id="transit-pass-ownership">
<span id="id10"></span><h2>Transit Pass Ownership<a class="headerlink" href="#transit-pass-ownership" title="Permalink to this heading">#</a></h2>
<p>The transit fare discount is defined as persons who purchase or are
provided a transit pass.  The transit fare discount consists of two submodels - this
transit pass ownership model and a person <a class="reference internal" href="#transit-pass-subsidy"><span class="std std-ref">Transit Pass Subsidy</span></a> model. The
result of this model can be used to condition downstream models such as the tour and trip
mode choice models via fare discount adjustments.</p>
<p>The main interface to the transit pass ownership model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">transit_pass_ownership()</span></code> function.  This
function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">persons</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">transit_pass_ownership</span></code> | Skims Keys: NA</p>
</section>
<section id="auto-ownership">
<span id="id11"></span><h2>Auto Ownership<a class="headerlink" href="#auto-ownership" title="Permalink to this heading">#</a></h2>
<p>The auto ownership model selects a number of autos for each household in the simulation.
The primary model components are household demographics, zonal density, and accessibility.</p>
<p>The main interface to the auto ownership model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">auto_ownership_simulate()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">households</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">auto_ownership</span></code> | Skims Keys: NA</p>
</section>
<section id="vehicle-type-choice">
<span id="id12"></span><h2>Vehicle Type Choice<a class="headerlink" href="#vehicle-type-choice" title="Permalink to this heading">#</a></h2>
<p>The vehicle type choice model selects a vehicle type for each household vehicle. A vehicle type
is a combination of the vehicle’s body type, age, and fuel type.  For example, a 13 year old
gas powered van would have a vehicle type of <em>van_13_gas</em>.</p>
<p>There are two vehicle type choice model structures implemented:</p>
<ol class="arabic simple">
<li><p>Simultaneous choice of body type, age, and fuel type.</p></li>
<li><p>Simultaneous choice of body type and age, with fuel type assigned from a probability distribution.</p></li>
</ol>
<p>The <em>vehicle_type_choice.yaml</em> file contains the following model specific options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SPEC</span></code>: Filename for input utility expressions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">COEFS</span></code>: Filename for input utility expression coefficients</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LOGIT_TYPE</span></code>: Specifies whether you are using a nested or multinomial logit structure</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">combinatorial_alts</span></code>: Specifies the alternatives for the choice model.
Has sub-categories of <code class="docutils literal notranslate"><span class="pre">body_type</span></code>, <code class="docutils literal notranslate"><span class="pre">age</span></code>, and <code class="docutils literal notranslate"><span class="pre">fuel_type</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PROBS_SPEC</span></code>: Filename for input fuel type probabilities. Supplying probabilities
corresponds to implementation structure 2 above, and not supplying probabilities would correspond to implementation structure 1.
If provided, the <code class="docutils literal notranslate"><span class="pre">fuel_type</span></code> category in <code class="docutils literal notranslate"><span class="pre">combinatorial_alts</span></code>
will be excluded from the model alternatives such that only body type and age are selected.  Input <code class="docutils literal notranslate"><span class="pre">PROBS_SPEC</span></code> table will have an index
column named <em>vehicle_type</em> which is a combination of body type and age in the form <code class="docutils literal notranslate"><span class="pre">{body</span> <span class="pre">type}_{age}</span></code>.  Subsequent column names
specify the fuel type that will be added and the column values are the probabilities of that fuel type.
The vehicle type model will select a fuel type for each vehicle based on the provided probabilities.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VEHICLE_TYPE_DATA_FILE</span></code>: Filename for input vehicle type data. Must have columns <code class="docutils literal notranslate"><span class="pre">body_type</span></code>, <code class="docutils literal notranslate"><span class="pre">fuel_type</span></code>, and <code class="docutils literal notranslate"><span class="pre">vehicle_year</span></code>.
Vehicle <code class="docutils literal notranslate"><span class="pre">age</span></code> is computed using the <code class="docutils literal notranslate"><span class="pre">FLEET_YEAR</span></code> option. Data for every alternative specified in the <code class="docutils literal notranslate"><span class="pre">combinatorial_alts</span></code> option must be included
in the file. Vehicle type data file will be joined to the alternatives and can be used in the utility expressions if <code class="docutils literal notranslate"><span class="pre">PROBS_SPEC</span></code> is not provided.
If <code class="docutils literal notranslate"><span class="pre">PROBS_SPEC</span></code> is provided, the vehicle type data will be joined after a vehicle type is decided so the data can be used in downstream models.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">COLS_TO_INCLUDE_IN_VEHICLE_TABLE</span></code>: List of columns from the vehicle type data file to include in the vehicle table that can be used in downstream models.
Examples of data that might be needed is vehicle range for the <a class="reference internal" href="#vehicle-allocation"><span class="std std-ref">Vehicle Allocation</span></a> model, auto operating costs to use in tour and trip mode choice,
and emissions data for post-model-run analysis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FLEET_YEAR</span></code>: Integer specifying the fleet year to be used in the model run. This is used to compute <code class="docutils literal notranslate"><span class="pre">age</span></code> in the
vehicle type data table where <code class="docutils literal notranslate"><span class="pre">age</span> <span class="pre">=</span> <span class="pre">(1</span> <span class="pre">+</span> <span class="pre">FLEET_YEAR</span> <span class="pre">-</span> <span class="pre">vehicle_year)</span></code>. Computing age on the fly with the <code class="docutils literal notranslate"><span class="pre">FLEET_YEAR</span></code> variable allows the
user flexibility to compile and share a single vehicle type data file containing all years and simply change the <code class="docutils literal notranslate"><span class="pre">FLEET_YEAR</span></code> to run
different scenario years.</p></li>
<li><p>Optional additional settings that work the same in other models are constants, expression preprocessor, and annotate tables.</p></li>
</ul>
<p>Input vehicle type data included in <a class="reference internal" href="examples.html#prototype-mtc-extended"><span class="std std-ref">prototype_mtc_extended</span></a> came from a variety of sources. The number of vehicle makes, models, MPG, and
electric vehicle range was sourced from the Enivornmental Protection Agency (EPA).  Additional data on vehicle costs were derived from the
National Household Travel Survey. Auto operating costs in the vehicle type data file were a sum of fuel costs and maintenance costs.
Fuel costs were calculated from MPG assuming a $3.00 cost for a gallon of gas. When MPG was not available to calculate fuel costs,
the closest year, vehicle type, or body type available was used. Maintenance costs were taken from AAA’s
<a class="reference external" href="https://exchange.aaa.com/wp-content/uploads/2017/08/17-0013_Your-Driving-Costs-Brochure-2017-FNL-CX-1.pdf">2017 driving cost study</a>.
Size categories within body types were averaged, e.g. car was an average of AAA’s small, medium, and large sedan categories.
Motorcycles were assigned the small sedan maintenance costs since they were not included in AAA’s report.
Maintenance costs were not varied by vehicle year. (According to
<a class="reference external" href="https://www.bls.gov/opub/btn/volume-3/pdf/americans-aging-autos.pdf">data from the U.S. Bureau of Labor Statistics</a>,
there was no consistent relationship between vehicle age and maintenance costs.)</p>
<p>Using the above methodology, the average auto operating costs of vehicles output from <a class="reference internal" href="examples.html#prototype-mtc-extended"><span class="std std-ref">prototype_mtc_extended</span></a> was 18.4 cents.
This value is very close to the auto operating cost of 18.3 cents used in <a class="reference internal" href="examples.html#prototype-mtc"><span class="std std-ref">prototype_mtc</span></a>.
Non-household vehicles in prototype_mtc_extended use the auto operating cost of 18.3 cents used in prototype_mtc.
Users are encouraged to make their own assumptions and calculate auto operating costs as they see fit.</p>
<p>The distribution of fuel type probabilities included in <a class="reference internal" href="examples.html#prototype-mtc-extended"><span class="std std-ref">prototype_mtc_extended</span></a> are computed directly from the National Household Travel Survey data
and include the entire US. Therefore, there is “lumpiness” in probabilities due to poor statistics in the data for some vehicle types.
The user is encouraged to adjust the probabilities to their modeling region and “smooth” them for more consistent results.</p>
<p>Further discussion of output results and model sensitivities can be found <a class="reference external" href="https://github.com/ActivitySim/activitysim/wiki/Project-Meeting-2022.05.05">here</a>.</p>
</section>
<section id="telecommute-frequency">
<span id="id13"></span><h2>Telecommute Frequency<a class="headerlink" href="#telecommute-frequency" title="Permalink to this heading">#</a></h2>
<p>Telecommuting is defined as workers who work from home instead of going to work. It only applies to
workers with a regular workplace outside of home. The telecommute model consists of two
submodels - a person <a class="reference internal" href="#work-from-home"><span class="std std-ref">Work From Home</span></a> model and this person telecommute frequency model.</p>
<p>For all workers that work out of the home, the telecommute models predicts the
level of telecommuting. The model alternatives are the frequency of telecommuting in
days per week (0 days, 1 day, 2 to 3 days, 4+ days).</p>
<p>The main interface to the work from home model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">telecommute_frequency()</span></code> function.  This
function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">persons</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">telecommute_frequency</span></code> | Skims Keys: NA</p>
</section>
<section id="free-parking-eligibility">
<span id="freeparking"></span><h2>Free Parking Eligibility<a class="headerlink" href="#free-parking-eligibility" title="Permalink to this heading">#</a></h2>
<p>The Free Parking Eligibility model predicts the availability of free parking at a person’s
workplace.  It is applied for people who work in zones that have parking charges, which are
generally located in the Central Business Districts. The purpose of the model is to adequately
reflect the cost of driving to work in subsequent models, particularly in mode choice.</p>
<p>The main interface to the free parking eligibility model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">free_parking()</span></code> function.  This function is registered
as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">persons</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">free_parking_at_work</span></code> | Skims Keys: NA</p>
</section>
<section id="coordinated-daily-activity-pattern">
<span id="cdap"></span><h2>Coordinated Daily Activity Pattern<a class="headerlink" href="#coordinated-daily-activity-pattern" title="Permalink to this heading">#</a></h2>
<p>The Coordinated Daily Activity Pattern (CDAP) model predicts the choice of daily activity pattern (DAP)
for each member in the household, simultaneously. The DAP is categorized in to three types as
follows:</p>
<blockquote>
<div><ul class="simple">
<li><p>Mandatory: the person engages in travel to at least one out-of-home mandatory activity - work, university, or school. The mandatory pattern may also include non-mandatory activities such as separate home-based tours or intermediate stops on mandatory tours.</p></li>
<li><p>Non-mandatory: the person engages in only maintenance and discretionary tours, which, by definition, do not contain mandatory activities.</p></li>
<li><p>Home: the person does not travel outside the home.</p></li>
</ul>
</div></blockquote>
<p>The CDAP model is a sequence of vectorized table operations:</p>
<ul class="simple">
<li><p>create a person level table and rank each person in the household for inclusion in the CDAP model.  Priority is given to full time workers (up to two), then to part time workers (up to two workers, of any type), then to children (youngest to oldest, up to three).  Additional members up to five are randomly included for the CDAP calculation.</p></li>
<li><p>solve individual M/N/H utilities for each person</p></li>
<li><p>take as input an interaction coefficients table and then programmatically produce and write out the expression files for households size 1, 2, 3, 4, and 5 models independent of one another</p></li>
<li><p>select households of size 1, join all required person attributes, and then read and solve the automatically generated expressions</p></li>
<li><p>repeat for households size 2, 3, 4, and 5. Each model is independent of one another.</p></li>
</ul>
<p>The main interface to the CDAP model is the <code class="xref py py-func docutils literal notranslate"><span class="pre">run_cdap()</span></code>
function.  This function is called by the Inject step <code class="docutils literal notranslate"><span class="pre">cdap_simulate</span></code> which is
registered as an Inject step in the example Pipeline.  There are two cdap class definitions in
ActivitySim.  The first is at <code class="xref py py-func docutils literal notranslate"><span class="pre">cdap()</span></code> and contains the Inject
wrapper for running it as part of the model pipeline.  The second is
at <code class="xref py py-func docutils literal notranslate"><span class="pre">cdap()</span></code> and contains CDAP model logic.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">persons</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">cdap_activity</span></code> | Skims Keys: NA</p>
</section>
<section id="mandatory-tour-frequency">
<span id="id14"></span><h2>Mandatory Tour Frequency<a class="headerlink" href="#mandatory-tour-frequency" title="Permalink to this heading">#</a></h2>
<p>The individual mandatory tour frequency model predicts the number of work and school tours
taken by each person with a mandatory DAP. The primary drivers of mandatory tour frequency
are demographics, accessibility-based parameters such as drive time to work, and household
automobile ownership.  It also creates mandatory tours in the data pipeline.</p>
<p>The main interface to the mandatory tour purpose frequency model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">mandatory_tour_frequency()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">persons</span></code> | Result Fields: <code class="docutils literal notranslate"><span class="pre">mandatory_tour_frequency</span></code> | Skims Keys: NA</p>
</section>
<section id="representative-logsums">
<span id="mandatory-tour-scheduling"></span><span id="id15"></span><h2>Mandatory Tour Scheduling<a class="headerlink" href="#representative-logsums" title="Permalink to this heading">#</a></h2>
<p>The mandatory tour scheduling model selects a tour departure and duration period (and therefore a
start and end period as well) for each mandatory tour.   The primary drivers in the model are
accessibility-based parameters such as the mode choice logsum for the departure/arrival hour
combination, demographics, and time pattern characteristics such as the time windows available
from previously scheduled tours. This model uses person <a class="reference internal" href="core.html#time-windows"><span class="std std-ref">Person Time Windows</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <code class="docutils literal notranslate"><span class="pre">prototype_mtc</span></code>, the modeled time periods for all submodels are hourly from 3 am to 3 am the next day, and any times before 5 am are shifted to time period 5, and any times after 11 pm are shifted to time period 23.</p>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">tour_departure_and_duration_segments.csv</span></code> is included in the configs, then the model
will use these representative start and end time periods when calculating mode choice logsums
instead of the specific start and end combinations for each alternative to reduce runtime.  This
feature, know as <code class="docutils literal notranslate"><span class="pre">representative</span> <span class="pre">logsums</span></code>, takes advantage of the fact that the mode choice logsum,
say, from 6 am to 2 pm is very similar to the logsum from 6 am to 3 pm, and 6 am to 4 pm, and so using
just 6 am to 3 pm (with the idea that 3 pm is the “representative time period”) for these alternatives is
sufficient for tour scheduling.  By reusing the 6 am to 3 pm mode choice logsum, ActivitySim saves
significant runtime.</p>
<p>The main interface to the mandatory tour purpose scheduling model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">mandatory_tour_scheduling()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tours</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">start,</span> <span class="pre">end,</span> <span class="pre">duration</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">TAZ,</span> <span class="pre">workplace_taz,</span> <span class="pre">school_taz,</span> <span class="pre">start,</span> <span class="pre">end</span></code></p>
</section>
<section id="school-escorting">
<span id="id16"></span><h2>School Escorting<a class="headerlink" href="#school-escorting" title="Permalink to this heading">#</a></h2>
<p>The school escort model determines whether children are dropped-off at or picked-up from school,
simultaneously with the chaperone responsible for chauffeuring the children,
which children are bundled together on half-tours, and the type of tour (pure escort versus rideshare).
The model is run after work and school locations have been chosen for all household members,
and after work and school tours have been generated and scheduled.
The model labels household members of driving age as potential ‘chauffeurs’ and children with school tours as potential ‘escortees’.
The model then attempts to match potential chauffeurs with potential escortees in a choice model whose alternatives
consist of ‘bundles’ of escortees with a chauffeur for each half tour.</p>
<p>School escorting is a household level decision – each household will choose an alternative from the <code class="docutils literal notranslate"><span class="pre">school_escorting_alts.csv</span></code> file,
with the first alternative being no escorting. This file contains the following columns:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>Column Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Alt</p></td>
<td><p>Alternative number</p></td>
</tr>
<tr class="row-odd"><td><p>bundle[1,2,3]</p></td>
<td><p>bundle number for child 1,2, and 3</p></td>
</tr>
<tr class="row-even"><td><p>chauf[1,2,3]</p></td>
<td><p>chauffeur number for child 1,2, and 3
- 0 = child not escorted
- 1 = chauffeur 1 as ride share
- 2 = chauffeur 1 as pure escort
- 3 = chauffeur 2 as ride share
- 4 = chauffeur 3 as pure escort</p></td>
</tr>
<tr class="row-odd"><td><p>nbund[1,2]</p></td>
<td><ul class="simple">
<li><p>number of escorting bundles for chauffeur 1 and 2</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>nbundles</p></td>
<td><ul class="simple">
<li><p>total number of bundles</p></li>
<li><p>equals nbund1 + nbund2</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>nrs1</p></td>
<td><ul class="simple">
<li><p>number of ride share bundles for chauffeur 1</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>npe1</p></td>
<td><ul class="simple">
<li><p>number of pure escort bundles for chauffeur 1</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>nrs2</p></td>
<td><ul class="simple">
<li><p>number of ride share bundles for chauffeur 2</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>npe2</p></td>
<td><ul class="simple">
<li><p>number of pure escort bundles for chauffeur 2</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Description</p></td>
<td><ul class="simple">
<li><p>text description of alternative</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The model as currently implemented contains three escortees and two chauffeurs.
Escortees are students under age 16 with a mandatory tour whereas chaperones are all persons in the household over the age of 18.
For households that have more than three possible escortees, the three youngest children are selected for the model.
The two chaperones are selected as the adults of the household with the highest weight according to the following calculation:
<span class="math notranslate nohighlight">\(Weight = 100*personType + 10*gender + 1*age(0,1)\)</span>
Where <em>personType</em> is the person type number from 1 to 5, <em>gender</em> is 1 for male and 2 for female, and
<em>age</em> is a binary indicator equal to 1 if age is over 25 else 0.</p>
<p>The model is run sequentially three times, once in the outbound direction, once in the inbound direction,
and again in the outbound direction with additional conditions on what happened in the inbound direction.
There are therefore three sets of utility specifications, coefficients, and pre-processor files.
Each of these files is specified in the school_escorting.yaml file along with the number of escortees and number of chaperones.</p>
<p>There is also a constants section in the school_escorting.yaml file which contain two constants.
One which sets the maximum time bin difference to match school and work tours for ride sharing
and another to set the number of minutes per time bin.
In the <a class="reference internal" href="examples.html#prototype-mtc-extended"><span class="std std-ref">prototype_mtc_extended</span></a> example, these are set to 1 and 60 respectively.</p>
<p>After a school escorting alternative is chosen for the inbound and outbound direction, the model will
create the tours and trips associated with the decision.  Pure escort tours are created,
and the mandatory tour start and end times are changed to match the school escort bundle start and end times.
(Outbound tours have their start times matched and inbound tours have their end times matched.)
Escortee drop-off / pick-up order is determined by the distance from home to the school locations.
They are ordered from smallest to largest in the outbound direction, and largest to smallest in the inbound direction.
Trips are created for each half-tour that includes school escorting according to the provided order.</p>
<p>The created pure escort tours are joined to the already created mandatory tour table in the pipeline
and are also saved separately to the pipeline under the table name “school_escort_tours”.
Created school escorting trips are saved to the pipeline under the table name “school_escort_trips”.
By saving these to the pipeline, their data can be queried in downstream models to set correct purposes,
destinations, and schedules to satisfy the school escorting model choice.</p>
<p>There are a host of downstream model changes that are involved when including the school escorting model.
The following list contains the models that are changed in some way when school escorting is included:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Joint tour scheduling:</strong> Joint tours are not allowed to be scheduled over school escort tours.
This happens automatically by updating the timetable object with the updated mandatory tour times
and created pure escort tour times after the school escorting model is run.
There were no code or config changes in this model, but it is still affected by school escorting.</p></li>
<li><p><strong>Non-Mandatory tour frequency:</strong>  Pure school escort tours are joined to the tours created in the
non-mandatory tour frequency model and tour statistics (such as tour_count and tour_num) are re-calculated.</p></li>
<li><p><strong>Non-Mandatory tour destination:</strong> Since the primary destination of pure school escort tours is known,
they are removed from the choosers table and have their destination set according to the destination inschool_escort_tours table.  They are also excluded from the estimation data bundle.</p></li>
<li><p><strong>Non-Mandatory tour scheduling:</strong> Pure escort tours need to have the non-escorting portion of their tour scheduled.
This is done by inserting availability conditions in the model specification that ensures the alternative
chosen for the start of the tour is equal to the alternative start time for outbound tours and the end time
is equal to the alternative end time for the inbound tours.  There are additional terms that ensure the tour
does not overlap with subsequent school escorting tours as well.  Beware – If the availability conditions
in the school escorting model are not set correctly, the tours created may not be consistent with each other
and this model will fail.</p></li>
<li><p><strong>Tour mode choice:</strong> Availability conditions are set in tour mode choice to prohibit the drive alone mode
if the tour contains an escortee and the shared-ride 2 mode if the tour contains more than one escortee.</p></li>
<li><p><strong>Stop Frequency:</strong> No stops are allowed on half-tours that include school escorting.
This is enforced by adding availability conditions in the stop frequency model.  After the stop frequency
model is run, the school escorting trips are merged from the trips created by the stop frequency model
and a new stop frequency is computed along with updated trip numbers.</p></li>
<li><p><strong>Trip purpose, destination, and scheduling:</strong> Trip purpose, destination, and departure times are known
for school escorting trips.  As such they are removed from their respective chooser tables and the estimation
data bundles, and set according to the values in the school_escort_trips table residing in the pipeline.</p></li>
<li><p><strong>Trip mode choice:</strong> Like in tour mode choice, availability conditions are set to prohibit trip containing
an escortee to use the drive alone mode or the shared-ride 2 mode for trips with more than one escortee.</p></li>
</ul>
</div></blockquote>
<p>Many of the changes discussed in the above list are handled in the code and the user is not required to make any
changes when implementing the school escorting model.  However, it is the users responsibility to include the
changes in the following model configuration files for models downstream of the school escorting model:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>File Name(s)</p></th>
<th class="head"><p>Change(s) Needed</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><ul class="simple">
<li><p><cite>non_mandatory_tour_scheduling_annotate_tours_preprocessor.csv</cite></p></li>
<li><p><cite>tour_scheduling_nonmandatory.csv</cite></p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>Set availability conditions based on those times</p></li>
<li><p>Do not schedule over other school escort tours</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li><p><cite>tour_mode_choice_annotate_choosers_preprocessor.csv</cite></p></li>
<li><p><cite>tour_mode_choice.csv</cite></p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>count number of escortees on tour by parsing the</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">escort_participants</span></code> column
- set mode choice availability based on number of escortees</p>
</td>
</tr>
<tr class="row-even"><td><ul class="simple">
<li><p><cite>stop_frequency_school.csv</cite></p></li>
<li><p><cite>stop_frequency_work.csv</cite></p></li>
<li><p><cite>stop_frequency_univ.csv</cite></p></li>
<li><p><cite>stop_frequency_escort.csv</cite></p></li>
</ul>
</td>
<td><p>Do not allow stops for half-tours that include school escorting</p></td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li><p><cite>trip_mode_choice_annotate_trips_preprocessor.csv</cite></p></li>
<li><p><cite>trip_mode_choice.csv</cite></p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>count number of escortees on trip by parsing the</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">escort_participants</span></code> column
- set mode choice availability based on number of escortees</p>
</td>
</tr>
</tbody>
</table>
<p>When not including the school escorting model, all of the escort trips to and from school are counted implicitly in
escort tours determined in the non-mandatory tour frequency model. Thus, when including the school escort model and
accounting for these tours explicitly, extra care should be taken not to double count them in the non-mandatory
tour frequency model. The non-mandatory tour frequency model should be re-evaluated and likely changed to decrease
the number of escort tours generated by that model.  This was not implemented in the <a class="reference internal" href="examples.html#prototype-mtc-extended"><span class="std std-ref">prototype_mtc_extended</span></a>
implementation due to a lack of data surrounding the number of escort tours in the region.</p>
</section>
<section id="joint-tour-frequency">
<span id="id17"></span><h2>Joint Tour Frequency<a class="headerlink" href="#joint-tour-frequency" title="Permalink to this heading">#</a></h2>
<p>The joint tour generation models are divided into three sub-models: the joint tour frequency
model, the party composition model, and the person participation model. In the joint tour
frequency model, the household chooses the purposes and number (up to two) of its fully joint
travel tours.  It also creates joints tours in the data pipeline.</p>
<p>The main interface to the joint tour purpose frequency model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">joint_tour_frequency()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">households</span></code> | Result Fields: <code class="docutils literal notranslate"><span class="pre">num_hh_joint_tours</span></code> | Skims Keys: NA</p>
</section>
<section id="joint-tour-composition">
<span id="id18"></span><h2>Joint Tour Composition<a class="headerlink" href="#joint-tour-composition" title="Permalink to this heading">#</a></h2>
<p>In the joint tour party composition model, the makeup of the travel party (adults, children, or
mixed - adults and children) is determined for each joint tour.  The party composition determines the
general makeup of the party of participants in each joint tour in order to allow the micro-simulation
to faithfully represent the prevalence of adult-only, children-only, and mixed joint travel tours
for each purpose while permitting simplicity in the subsequent person participation model.</p>
<p>The main interface to the joint tour composition model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">joint_tour_composition()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tours</span></code> | Result Fields: <code class="docutils literal notranslate"><span class="pre">composition</span></code> | Skims Keys: NA</p>
</section>
<section id="joint-tour-participation">
<span id="id19"></span><h2>Joint Tour Participation<a class="headerlink" href="#joint-tour-participation" title="Permalink to this heading">#</a></h2>
<p>In the joint tour person participation model, each eligible person sequentially makes a
choice to participate or not participate in each joint tour.  Since the party composition model
determines what types of people are eligible to join a given tour, the person participation model
can operate in an iterative fashion, with each household member choosing to join or not to join
a travel party independent of the decisions of other household members. In the event that the
constraints posed by the result of the party composition model are not met, the person
participation model cycles through the household members multiple times until the required
types of people have joined the travel party.</p>
<p>This step also creates the <code class="docutils literal notranslate"><span class="pre">joint_tour_participants</span></code> table in the pipeline, which stores the
person ids for each person on the tour.</p>
<p>The main interface to the joint tour participation model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">joint_tour_participation()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tours</span></code> | Result Fields: <code class="docutils literal notranslate"><span class="pre">number_of_participants,</span> <span class="pre">person_id</span> <span class="pre">(for</span> <span class="pre">the</span> <span class="pre">point</span> <span class="pre">person)</span></code> | Skims Keys: NA</p>
</section>
<section id="joint-tour-destination-choice">
<span id="id20"></span><h2>Joint Tour Destination Choice<a class="headerlink" href="#joint-tour-destination-choice" title="Permalink to this heading">#</a></h2>
<p>The joint tour destination choice model operate similarly to the usual work and
school location choice model, selecting the primary destination for travel tours. The only
procedural difference between the models is that the usual work and school location choice
model selects the usual location of an activity whether or not the activity is undertaken during the
travel day, while the joint tour destination choice model selects the location for an
activity which has already been generated.</p>
<p>The tour’s primary destination is the location of the activity that is assumed to provide the greatest
impetus for engaging in the travel tour. In the household survey, the primary destination was not asked, but
rather inferred from the pattern of stops in a closed loop in the respondents’ travel diaries. The
inference was made by weighing multiple criteria including a defined hierarchy of purposes, the
duration of activities, and the distance from the tour origin. The model operates in the reverse
direction, designating the primary purpose and destination and then adding intermediate stops
based on spatial, temporal, and modal characteristics of the inbound and outbound journeys to
the primary destination.</p>
<dl class="simple">
<dt>The joint tour destination choice model is made up of three model steps:</dt><dd><ul class="simple">
<li><p>sample - selects a sample of alternative locations for the next model step. This selects X locations from the full set of model zones using a simple utility.</p></li>
<li><p>logsums - starts with the table created above and calculates and adds the mode choice logsum expression for each alternative location.</p></li>
<li><p>simulate - starts with the table created above and chooses a final location, this time with the mode choice logsum included.</p></li>
</ul>
</dd>
</dl>
<p>Joint tour location choice for <a class="reference internal" href="examples.html#multiple-zone-systems"><span class="std std-ref">placeholder_multiple_zone</span></a> models uses <a class="reference internal" href="examples.html#presampling"><span class="std std-ref">Presampling</span></a> by default.</p>
<p>The main interface to the model is the <code class="xref py py-func docutils literal notranslate"><span class="pre">joint_tour_destination()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.  See <a class="reference internal" href="examples.html#writing-logsums"><span class="std std-ref">Writing Logsums</span></a> for how
to write logsums for estimation.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tours</span></code> | Result Fields: <code class="docutils literal notranslate"><span class="pre">destination</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">TAZ,</span> <span class="pre">alt_dest,</span> <span class="pre">MD</span> <span class="pre">time</span> <span class="pre">period</span></code></p>
</section>
<section id="joint-tour-scheduling">
<span id="id21"></span><h2>Joint Tour Scheduling<a class="headerlink" href="#joint-tour-scheduling" title="Permalink to this heading">#</a></h2>
<p>The joint tour scheduling model selects a tour departure and duration period (and therefore a start and end
period as well) for each joint tour.  This model uses person <a class="reference internal" href="core.html#time-windows"><span class="std std-ref">Person Time Windows</span></a>. The primary drivers in the
models are accessibility-based parameters such
as the auto travel time for the departure/arrival hour combination, demographics, and time
pattern characteristics such as the time windows available from previously scheduled tours.
The joint tour scheduling model does not use mode choice logsums.</p>
<p>The main interface to the joint tour purpose scheduling model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">joint_tour_scheduling()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tours</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">start,</span> <span class="pre">end,</span> <span class="pre">duration</span></code> | Skims Keys: `` TAZ, destination, MD time period, MD time period``</p>
</section>
<section id="non-mandatory-tour-frequency">
<span id="id22"></span><h2>Non-Mandatory Tour Frequency<a class="headerlink" href="#non-mandatory-tour-frequency" title="Permalink to this heading">#</a></h2>
<p>The non-mandatory tour frequency model selects the number of non-mandatory tours made by each person on the simulation day.
It also adds non-mandatory tours to the tours in the data pipeline. The individual non-mandatory tour frequency model
operates in two stages:</p>
<blockquote>
<div><ul class="simple">
<li><p>A choice is made using a random utility model between combinations of tours containing zero, one, and two or more escort tours, and between zero and one or more tours of each other purpose.</p></li>
<li><p>Up to two additional tours of each purpose are added according to fixed extension probabilities.</p></li>
</ul>
</div></blockquote>
<p>The main interface to the non-mandatory tour purpose frequency model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">non_mandatory_tour_frequency()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">persons</span></code> | Result Fields: <code class="docutils literal notranslate"><span class="pre">non_mandatory_tour_frequency</span></code> | Skims Keys: NA</p>
</section>
<section id="non-mandatory-tour-destination-choice">
<span id="id23"></span><h2>Non-Mandatory Tour Destination Choice<a class="headerlink" href="#non-mandatory-tour-destination-choice" title="Permalink to this heading">#</a></h2>
<p>The non-mandatory tour destination choice model chooses a destination zone for
non-mandatory tours.  The three step (sample, logsums, final choice) process also used for
mandatory tour destination choice is used for non-mandatory tour destination choice.</p>
<p>Non-mandatory tour location choice for <a class="reference internal" href="examples.html#multiple-zone-systems"><span class="std std-ref">placeholder_multiple_zone</span></a> models uses <a class="reference internal" href="examples.html#presampling"><span class="std std-ref">Presampling</span></a> by default.</p>
<p>The main interface to the non-mandatory tour destination choice model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">non_mandatory_tour_destination()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.  See <a class="reference internal" href="examples.html#writing-logsums"><span class="std std-ref">Writing Logsums</span></a>
for how to write logsums for estimation.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tours</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">destination</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">TAZ,</span> <span class="pre">alt_dest,</span> <span class="pre">MD</span> <span class="pre">time</span> <span class="pre">period,</span> <span class="pre">MD</span> <span class="pre">time</span> <span class="pre">period</span></code></p>
</section>
<section id="non-mandatory-tour-scheduling">
<span id="id24"></span><h2>Non-Mandatory Tour Scheduling<a class="headerlink" href="#non-mandatory-tour-scheduling" title="Permalink to this heading">#</a></h2>
<p>The non-mandatory tour scheduling model selects a tour departure and duration period (and therefore a start and end
period as well) for each non-mandatory tour.  This model uses person <a class="reference internal" href="core.html#time-windows"><span class="std std-ref">Person Time Windows</span></a>.  Includes support
for <a class="reference internal" href="#representative-logsums"><span class="std std-ref">Mandatory Tour Scheduling</span></a>.</p>
<p>The main interface to the non-mandatory tour purpose scheduling model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">non_mandatory_tour_scheduling()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tours</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">start,</span> <span class="pre">end,</span> <span class="pre">duration</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">TAZ,</span> <span class="pre">destination,</span> <span class="pre">MD</span> <span class="pre">time</span> <span class="pre">period,</span> <span class="pre">MD</span> <span class="pre">time</span> <span class="pre">period</span></code></p>
</section>
<section id="vehicle-allocation">
<span id="id25"></span><h2>Vehicle Allocation<a class="headerlink" href="#vehicle-allocation" title="Permalink to this heading">#</a></h2>
<p>The vehicle allocation model selects which vehicle would be used for a tour of given occupancy. The alternatives for the vehicle
allocation model consist of the vehicles owned by the household and an additional non household vehicle option. (Zero-auto
households would be assigned the non-household vehicle option since there are no owned vehicles in the household).
A vehicle is selected for each occupancy level set by the user such that different tour modes that have different occupancies could see different operating
characteristics. The output of the vehicle allocation model is appended to the tour table with column names <code class="docutils literal notranslate"><span class="pre">vehicle_occup_{occupancy}</span></code> and the values are
the vehicle type selected.</p>
<p>In <a class="reference internal" href="examples.html#prototype-mtc-extended"><span class="std std-ref">prototype_mtc_extended</span></a>, three occupancy levels are used: 1, 2, and 3.5.  The auto operating cost
for occupancy level 1 is used in the drive alone mode and drive to transit modes. Occupancy levels 2 and 3.5 are used for shared
ride 2 and shared ride 3+ auto operating costs, respectively.  Auto operating costs are selected in the mode choice pre-processors by selecting the allocated
vehicle type data from the vehicles table. If the allocated vehicle type was the non-household vehicle, the auto operating costs uses
the previous default value from <a class="reference internal" href="examples.html#prototype-mtc"><span class="std std-ref">prototype_mtc</span></a>. All trips and atwork subtours use the auto operating cost of the parent tour.  Functionality
was added in tour and atwork subtour mode choice to annotate the tour table and create a <code class="docutils literal notranslate"><span class="pre">selected_vehicle</span></code> which denotes the actual vehicle used.
If the tour mode does not include a vehicle, then the <code class="docutils literal notranslate"><span class="pre">selected_vehicle</span></code> entry is left blank.</p>
<p>The current implementation does not account for possible use of the household vehicles by other household members.  Thus, it is possible for a
selected vehicle to be used in two separate tours at the same time.</p>
</section>
<section id="tour-mode-choice">
<span id="id26"></span><h2>Tour Mode Choice<a class="headerlink" href="#tour-mode-choice" title="Permalink to this heading">#</a></h2>
<p>The mandatory, non-mandatory, and joint tour mode choice model assigns to each tour the “primary” mode that
is used to get from the origin to the primary destination. The tour-based modeling approach requires a reconsideration
of the conventional mode choice structure. Instead of a single mode choice model used in a four-step
structure, there are two different levels where the mode choice decision is modeled: (a) the
tour mode level (upper-level choice); and, (b) the trip mode level (lower-level choice conditional
upon the upper-level choice).</p>
<p>The mandatory, non-mandatory, and joint tour mode level represents the decisions that apply to the entire tour, and
that will affect the alternatives available for each individual trip or joint trip. These decisions include the choice to use a private
car versus using public transit, walking, or biking; whether carpooling will be considered; and
whether transit will be accessed by car or by foot. Trip-level decisions correspond to details of
the exact mode used for each trip, which may or may not change over the trips in the tour.</p>
<p>The mandatory, non-mandatory, and joint tour mode choice structure is a nested logit model which separates
similar modes into different nests to more accurately model the cross-elasticities between the alternatives. The
eighteen modes are incorporated into the nesting structure specified in the model settings file. The
first level of nesting represents the use a private car, non-motorized
means, or transit. In the second level of nesting, the auto nest is divided into vehicle occupancy
categories, and transit is divided into walk access and drive access nests. The final level splits
the auto nests into free or pay alternatives and the transit nests into the specific line-haul modes.</p>
<p>The primary variables are in-vehicle time, other travel times, cost (the influence of which is derived
from the automobile in-vehicle time coefficient and the persons’ modeled value of time),
characteristics of the destination zone, demographics, and the household’s level of auto
ownership.</p>
<p>The main interface to the mandatory, non-mandatory, and joint tour mode model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">tour_mode_choice_simulate()</span></code> function.  This function is
called in the Inject step <code class="docutils literal notranslate"><span class="pre">tour_mode_choice_simulate</span></code> and is registered as an Inject step in the example Pipeline.
See <a class="reference internal" href="examples.html#writing-logsums"><span class="std std-ref">Writing Logsums</span></a> for how to write logsums for estimation.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tours</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">mode</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">TAZ,</span> <span class="pre">destination,</span> <span class="pre">start,</span> <span class="pre">end</span></code></p>
</section>
<section id="at-work-subtours-frequency">
<span id="atwork-subtour-frequency"></span><h2>At-work Subtours Frequency<a class="headerlink" href="#at-work-subtours-frequency" title="Permalink to this heading">#</a></h2>
<p>The at-work subtour frequency model selects the number of at-work subtours made for each work tour.
It also creates at-work subtours by adding them to the tours table in the data pipeline.
These at-work sub-tours are travel tours taken during the workday with their origin at the work
location, rather than from home. Explanatory variables include employment status,
income, auto ownership, the frequency of other tours, characteristics of the parent work tour, and
characteristics of the workplace zone.</p>
<p>Choosers: work tours
Alternatives: none, 1 eating out tour, 1 business tour, 1 maintenance tour, 2 business tours, 1 eating out tour + 1 business tour
Dependent tables: household, person, accessibility
Outputs: work tour subtour frequency choice, at-work tours table (with only tour origin zone at this point)</p>
<p>The main interface to the at-work subtours frequency model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">atwork_subtour_frequency()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tours</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">atwork_subtour_frequency</span></code> | Skims Keys: NA</p>
</section>
<section id="at-work-subtours-destination-choice">
<span id="atwork-subtour-destination"></span><h2>At-work Subtours Destination Choice<a class="headerlink" href="#at-work-subtours-destination-choice" title="Permalink to this heading">#</a></h2>
<p>The at-work subtours destination choice model is made up of three model steps:</p>
<blockquote>
<div><ul class="simple">
<li><p>sample - selects a sample of alternative locations for the next model step. This selects X locations from the full set of model zones using a simple utility.</p></li>
<li><p>logsums - starts with the table created above and calculates and adds the mode choice logsum expression for each alternative location.</p></li>
<li><p>simulate - starts with the table created above and chooses a final location, this time with the mode choice logsum included.</p></li>
</ul>
</div></blockquote>
<p>At-work subtour location choice for <a class="reference internal" href="examples.html#multiple-zone-systems"><span class="std std-ref">placeholder_multiple_zone</span></a> models uses <a class="reference internal" href="examples.html#presampling"><span class="std std-ref">Presampling</span></a> by default.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tours</span></code> | Result Table: <code class="docutils literal notranslate"><span class="pre">destination</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">workplace_taz,</span> <span class="pre">alt_dest,</span> <span class="pre">MD</span> <span class="pre">time</span> <span class="pre">period</span></code></p>
<p>The main interface to the at-work subtour destination model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">atwork_subtour_destination()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.
See <a class="reference internal" href="examples.html#writing-logsums"><span class="std std-ref">Writing Logsums</span></a> for how to write logsums for estimation.</p>
</section>
<section id="at-work-subtour-scheduling">
<span id="atwork-subtour-scheduling"></span><h2>At-work Subtour Scheduling<a class="headerlink" href="#at-work-subtour-scheduling" title="Permalink to this heading">#</a></h2>
<p>The at-work subtours scheduling model selects a tour departure and duration period (and therefore a start and end
period as well) for each at-work subtour.  This model uses person <a class="reference internal" href="core.html#time-windows"><span class="std std-ref">Person Time Windows</span></a>.</p>
<p>This model is the same as the mandatory tour scheduling model except it operates on the at-work tours and
constrains the alternative set to available person <a class="reference internal" href="core.html#time-windows"><span class="std std-ref">Person Time Windows</span></a>.  The at-work subtour scheduling model does not use mode choice logsums.
The at-work subtour frequency model can choose multiple tours so this model must process all first tours and then second
tours since isFirstAtWorkTour is an explanatory variable.</p>
<p>Choosers: at-work tours
Alternatives: alternative departure time and arrival back at origin time pairs WITHIN the work tour departure time and arrival time back at origin AND the person time window. If no time window is available for the tour, make the first and last time periods within the work tour available, make the choice, and log the number of times this occurs.
Dependent tables: skims, person, land use, work tour
Outputs: at-work tour departure time and arrival back at origin time, updated person time windows</p>
<p>The main interface to the at-work subtours scheduling model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">atwork_subtour_scheduling()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tours</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">start,</span> <span class="pre">end,</span> <span class="pre">duration</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">workplace_taz,</span> <span class="pre">alt_dest,</span> <span class="pre">MD</span> <span class="pre">time</span> <span class="pre">period,</span> <span class="pre">MD</span> <span class="pre">time</span> <span class="pre">period</span></code></p>
</section>
<section id="at-work-subtour-mode">
<span id="atwork-subtour-mode-choice"></span><h2>At-work Subtour Mode<a class="headerlink" href="#at-work-subtour-mode" title="Permalink to this heading">#</a></h2>
<p>The at-work subtour mode choice model assigns a travel mode to each at-work subtour using the <a class="reference internal" href="#tour-mode-choice"><span class="std std-ref">Tour Mode Choice</span></a> model.</p>
<p>The main interface to the at-work subtour mode choice model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">atwork_subtour_mode_choice()</span></code>
function.  This function is called in the Inject step <code class="docutils literal notranslate"><span class="pre">atwork_subtour_mode_choice</span></code> and
is registered as an Inject step in the example Pipeline.
See <a class="reference internal" href="examples.html#writing-logsums"><span class="std std-ref">Writing Logsums</span></a> for how to write logsums for estimation.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tour</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">tour_mode</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">workplace_taz,</span> <span class="pre">destination,</span> <span class="pre">start,</span> <span class="pre">end</span></code></p>
</section>
<section id="intermediate-stop-frequency">
<span id="id27"></span><h2>Intermediate Stop Frequency<a class="headerlink" href="#intermediate-stop-frequency" title="Permalink to this heading">#</a></h2>
<p>The stop frequency model assigns to each tour the number of intermediate destinations a person
will travel to on each leg of the tour from the origin to tour primary destination and back.
The model incorporates the ability for more than one stop in each direction,
up to a maximum of 3, for a total of 8 trips per tour (four on each tour leg).</p>
<p>Intermediate stops are not modeled for drive-transit tours because doing so can have unintended
consequences because of the difficulty of tracking the location of the vehicle. For example,
consider someone who used a park and ride for work and then took transit to an intermediate
shopping stop on the way home. Without knowing the vehicle location, it cannot be determined
if it is reasonable to allow the person to drive home. Even if the tour were constrained to allow
driving only on the first and final trip, the trip home from an intermediate stop may not use the
same park and ride where the car was dropped off on the outbound leg, which is usually as close
as possible to home because of the impracticality of coding drive access links from every park
and ride lot to every zone.</p>
<p>This model also creates a trips table in the pipeline for later models.</p>
<p>The main interface to the intermediate stop frequency model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">stop_frequency()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tours</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">stop_frequency</span></code> | Skims Keys: NA</p>
</section>
<section id="trip-purpose">
<span id="id28"></span><h2>Trip Purpose<a class="headerlink" href="#trip-purpose" title="Permalink to this heading">#</a></h2>
<p>For trip other than the last trip outbound or inbound, assign a purpose based on an
observed frequency distribution.  The distribution is segmented by tour purpose, tour
direction and person type. Work tours are also segmented by departure or arrival time period.</p>
<p>The main interface to the trip purpose model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">trip_purpose()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">trips</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">purpose</span></code> | Skims Keys: NA</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Trip purpose and trip destination choice can be run iteratively together via <a class="reference internal" href="#trip-purpose-and-destination-model"><span class="std std-ref">Trip Purpose and Destination</span></a>.</p>
</div>
</section>
<section id="trip-destination-choice">
<span id="id29"></span><h2>Trip Destination Choice<a class="headerlink" href="#trip-destination-choice" title="Permalink to this heading">#</a></h2>
<p>See <a class="reference internal" href="dev-guide/components/trip_destination.html#component-trip-destination"><span class="std std-ref">Trip Destination</span></a>.</p>
</section>
<section id="trip-purpose-and-destination">
<span id="trip-purpose-and-destination-model"></span><h2>Trip Purpose and Destination<a class="headerlink" href="#trip-purpose-and-destination" title="Permalink to this heading">#</a></h2>
<p>After running trip purpose and trip destination separately, the two model can be ran together in an iterative fashion on
the remaining failed trips (i.e. trips that cannot be assigned a destination).  Each iteration uses new random numbers.</p>
<p>The main interface to the trip purpose model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">trip_purpose_and_destination()</span></code>
function.  This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">trips</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">purpose,</span> <span class="pre">destination</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">origin,</span> <span class="pre">(tour</span> <span class="pre">primary)</span> <span class="pre">destination,</span> <span class="pre">dest_taz,</span> <span class="pre">trip_period</span></code></p>
</section>
<section id="trip-scheduling-probabilistic">
<span id="trip-scheduling"></span><h2>Trip Scheduling (Probabilistic)<a class="headerlink" href="#trip-scheduling-probabilistic" title="Permalink to this heading">#</a></h2>
<p>For each trip, assign a departure hour based on an input lookup table of percents by tour purpose,
direction (inbound/outbound), tour hour, and trip index.</p>
<blockquote>
<div><ul class="simple">
<li><p>The tour hour is the tour start hour for outbound trips and the tour end hour for inbound trips.  The trip index is the trip sequence on the tour, with up to four trips per half tour</p></li>
<li><p>For outbound trips, the trip depart hour must be greater than or equal to the previously selected trip depart hour</p></li>
<li><p>For inbound trips, trips are handled in reverse order from the next-to-last trip in the leg back to the first. The tour end hour serves as the anchor time point from which to start assigning trip time periods.</p></li>
<li><p>Outbound trips on at-work subtours are assigned the tour depart hour and inbound trips on at-work subtours are assigned the tour end hour.</p></li>
</ul>
</div></blockquote>
<p>The assignment of trip depart time is run iteratively up to a max number of iterations since it is possible that
the time period selected for an earlier trip in a half-tour makes selection of a later trip time
period impossible (or very low probability). Thus, the sampling is re-run until a feasible set of trip time
periods is found. If a trip can’t be scheduled after the max iterations, then the trip is assigned
the previous trip’s choice (i.e. assumed to happen right after the previous trip) or dropped, as configured by the user.
The trip scheduling model does not use mode choice logsums.</p>
<p>Alternatives: Available time periods in the tour window (i.e. tour start and end period).  When processing stops on
work tours, the available time periods is constrained by the at-work subtour start and end period as well.</p>
<p>In order to avoid trip failing, a new probabilistic trip scheduling mode was developed named “relative”.
When setting the _scheduling_mode_ option to relative, trips are scheduled relative to the previously scheduled trips.
The first trip still departs when the tour starts and for every subsequent trip, the choices are selected with respect to
the previous trip depart time. Inbound trips are no longer handled in reverse order.  The key to this relative mode is to
index the probabilities based on how much time is remaining on the tour.  For tours that include subtours, the time remaining will
be based on the subtour start time for outbound trips and will resume again for inbound trips after the subtour ends.
By indexing the probabilities based on time remaining and scheduling relative to the previous trip, scheduling trips in relative
mode will not fail.  Note also that relative scheduling mode requires the use of logic
version 2 (see warning about logic versions, below).</p>
<p>An example of trip scheduling in relative mode is included in the <a class="reference internal" href="examples.html#prototype-mwcog"><span class="std std-ref">prototype_mwcog</span></a> example.  In this example, trip
scheduling probabilities are indexed by the following columns:</p>
<blockquote>
<div><ul class="simple">
<li><p>periods_left_min: the minimum bin for the number of time periods left on the tour.</p></li>
<li><p>periods_left_max: the maximum bin for the number of time periods left on the tour.  This is the same as periods_left_min until the final time period bin.</p></li>
<li><p>outbound: whether the trip occurs on the outbound leg of a tour.</p></li>
<li><p>tour_purpose_grouped: Tour purpose grouped into mandatory and non-mandatory categories</p></li>
<li><p>half_tour_stops_remaining_grouped: The number of stops remaining on the half tour with the categories of 0 and 1+</p></li>
</ul>
</div></blockquote>
<p>Each of these variables are listed as merge columns in the trip_scheduling.yaml file and are declared in the trip scheduling preprocessor.
The variables above attempt to balance the statistics available for probability creation with the amount of segmentation of trip characteristics.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Earlier versions of ActivitySim contained a logic error in this model, whereby
the earliest departure time for inbound legs was bounded by the maximum outbound
departure time, even if there was a scheduling failure for one or more outbound
leg departures and that bound was NA.  For continuity, this process has been
retained in this ActivitySim component as <em>logic_version</em> 1, and it remains the
default process if the user does not explicitly specify a logic version in the
model settings yaml file. The revised logic includes bounding inbound legs only
when the maximum outbound departure time is well defined.  This version of the
model can be used by explicitly setting <cite>logic_version: 2</cite> (or greater) in the
model settings yaml file.  It is strongly recommended that all new model
development efforts use logic version 2; a future version of ActivitySim may
make this the default for this component, and/or remove logic version 1 entirely.</p>
</div>
<p>The main interface to the trip scheduling model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">trip_scheduling()</span></code> function.
This function is registered as an Inject step in the example Pipeline.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">trips</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">depart</span></code> | Skims Keys: NA</p>
</section>
<section id="trip-scheduling-choice-logit-choice">
<span id="trip-scheduling-choice"></span><h2>Trip Scheduling Choice (Logit Choice)<a class="headerlink" href="#trip-scheduling-choice-logit-choice" title="Permalink to this heading">#</a></h2>
<p>This model uses a logit-based formulation to determine potential trip windows for the three
main components of a tour.</p>
<ul class="simple">
<li><p>Outbound Leg: The time from leaving the origin location to the time second to last outbound stop.</p></li>
<li><p>Main Leg: The time window from the last outbound stop through the main tour destination to the first inbound stop.</p></li>
<li><p>Inbound Leg: The time window from the first inbound stop to the tour origin location.</p></li>
</ul>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">tours</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">outbound_duration</span></code>, <code class="docutils literal notranslate"><span class="pre">main_leg_duration</span></code>, <code class="docutils literal notranslate"><span class="pre">inbound_duration</span></code> | Skims Keys: NA</p>
<p><strong>Required YAML attributes:</strong></p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">SPECIFICATION</span></code></dt><dd><p>This file defines the logit specification for each chooser segment.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">COEFFICIENTS</span></code></dt><dd><p>Specification coefficients</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">PREPROCESSOR</span></code>:</dt><dd><p>Preprocessor definitions to run on the chooser dataframe (trips) before the model is run</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="trip-departure-choice-logit-choice">
<span id="trip-departure-choice"></span><h2>Trip Departure Choice (Logit Choice)<a class="headerlink" href="#trip-departure-choice-logit-choice" title="Permalink to this heading">#</a></h2>
<p>Used in conjuction with Trip Scheduling Choice (Logit Choice), this model chooses departure
time periods consistent with the time windows for the appropriate leg of the trip.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">trips</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">depart</span></code> | Skims Keys: NA</p>
<p><strong>Required YAML attributes:</strong></p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">SPECIFICATION</span></code></dt><dd><p>This file defines the logit specification for each chooser segment.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">COEFFICIENTS</span></code></dt><dd><p>Specification coefficients</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">PREPROCESSOR</span></code>:</dt><dd><p>Preprocessor definitions to run on the chooser dataframe (trips) before the model is run</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="trip-mode-choice">
<span id="id30"></span><h2>Trip Mode Choice<a class="headerlink" href="#trip-mode-choice" title="Permalink to this heading">#</a></h2>
<p>The trip mode choice model assigns a travel mode for each trip on a given tour. It
operates similarly to the tour mode choice model, but only certain trip modes are available for
each tour mode. The correspondence rules are defined according to the following principles:</p>
<blockquote>
<div><ul class="simple">
<li><p>Pay trip modes are only available for pay tour modes (for example, drive-alone pay is only available at the trip mode level if drive-alone pay is selected as a tour mode).</p></li>
<li><p>The auto occupancy of the tour mode is determined by the maximum occupancy across all auto trips that make up the tour. Therefore, the auto occupancy for the tour mode is the maximum auto occupancy for any trip on the tour.</p></li>
<li><p>Transit tours can include auto shared-ride trips for particular legs. Therefore, ‘casual carpool’, wherein travelers share a ride to work and take transit back to the tour origin, is explicitly allowed in the tour/trip mode choice model structure.</p></li>
<li><p>The walk mode is allowed for any trip.</p></li>
<li><p>The availability of transit line-haul submodes on transit tours depends on the skimming and tour mode choice hierarchy. Free shared-ride modes are also available in walk-transit tours, albeit with a low probability. Paid shared-ride modes are not allowed on transit tours because no stated preference data is available on the sensitivity of transit riders to automobile value tolls, and no observed data is available to verify the number of people shifting into paid shared-ride trips on transit tours.</p></li>
</ul>
</div></blockquote>
<p>The trip mode choice models explanatory variables include household and person variables, level-of-service
between the trip origin and destination according to the time period for the tour leg, urban form
variables, and alternative-specific constants segmented by tour mode.</p>
<p>The main interface to the trip mode choice model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">trip_mode_choice()</span></code> function.  This function
is registered as an Inject step in the example Pipeline.  See <a class="reference internal" href="examples.html#writing-logsums"><span class="std std-ref">Writing Logsums</span></a> for how to write logsums for estimation.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">trips</span></code> | Result Field: <code class="docutils literal notranslate"><span class="pre">trip_mode</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">origin,</span> <span class="pre">destination,</span> <span class="pre">trip_period</span></code></p>
</section>
<section id="parking-location-choice">
<span id="id31"></span><h2>Parking Location Choice<a class="headerlink" href="#parking-location-choice" title="Permalink to this heading">#</a></h2>
<p>The parking location choice model selects a parking location for specified trips. While the model does not
require parking location be applied to any specific set of trips, it is usually applied for drive trips to
specific zones (e.g., CBD) in the model.</p>
<p>The model provides provides a filter for both the eligible choosers and eligible parking location zone. The
trips dataframe is the chooser of this model. The zone selection filter is applied to the land use zones
dataframe.</p>
<p>If this model is specified in the pipeline, the <a class="reference internal" href="#id32">Write Trip Matrices</a> step will using the parking location
choice results to build trip tables in lieu of the trip destination.</p>
<p>The main interface to the trip mode choice model is the
<code class="xref py py-func docutils literal notranslate"><span class="pre">parking_location_choice()</span></code> function.  This function
is registered as an Inject step, and it is available from the pipeline.  See <a class="reference internal" href="examples.html#writing-logsums"><span class="std std-ref">Writing Logsums</span></a> for how to write
logsums for estimation.</p>
<p><strong>Skims</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">odt_skims</span></code>: Origin to Destination by Time of Day</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dot_skims</span></code>: Destination to Origin by Time of Day</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">opt_skims</span></code>: Origin to Parking Zone by Time of Day</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pdt_skims</span></code>: Parking Zone to Destination by Time of Day</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">od_skims</span></code>: Origin to Destination</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_skims</span></code>: Destination to Origin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">op_skims</span></code>: Origin to Parking Zone</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pd_skims</span></code>: Parking Zone to Destination</p></li>
</ul>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">trips</span></code></p>
<p><strong>Required YAML attributes:</strong></p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">SPECIFICATION</span></code></dt><dd><p>This file defines the logit specification for each chooser segment.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">COEFFICIENTS</span></code></dt><dd><p>Specification coefficients</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">PREPROCESSOR</span></code>:</dt><dd><p>Preprocessor definitions to run on the chooser dataframe (trips) before the model is run</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">CHOOSER_FILTER_COLUMN_NAME</span></code></dt><dd><p>Boolean field on the chooser table defining which choosers are eligible to parking location choice model. If no
filter is specified, all choosers (trips) are eligible for the model.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">CHOOSER_SEGMENT_COLUMN_NAME</span></code></dt><dd><p>Column on the chooser table defining the parking segment for the logit model</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">SEGMENTS</span></code></dt><dd><p>List of eligible chooser segments in the logit specification</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">ALTERNATIVE_FILTER_COLUMN_NAME</span></code></dt><dd><p>Boolean field used to filter land use zones as eligible parking location choices. If no filter is specified,
then all land use zones are considered as viable choices.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">ALT_DEST_COL_NAME</span></code></dt><dd><p>The column name to append with the parking location choice results. For choosers (trips) ineligible for this
model, a -1 value will be placed in column.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">TRIP_ORIGIN</span></code></dt><dd><p>Origin field on the chooser trip table</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">TRIP_DESTINATION</span></code></dt><dd><p>Destination field on the chooser trip table</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="write-trip-matrices">
<span id="id32"></span><h2>Write Trip Matrices<a class="headerlink" href="#write-trip-matrices" title="Permalink to this heading">#</a></h2>
<p>Write open matrix (OMX) trip matrices for assignment.  Reads the trips table post preprocessor and run expressions
to code additional data fields, with one data fields for each matrix specified.  The matrices are scaled by a
household level expansion factor, which is the household sample rate by default, which is calculated when
households are read in at the beginning of a model run.  The main interface to write trip
matrices is the <code class="xref py py-func docutils literal notranslate"><span class="pre">write_trip_matrices()</span></code> function.  This function
is registered as an Inject step in the example Pipeline.</p>
<p>If the <a class="reference internal" href="#id31">Parking Location Choice</a> model is defined in the pipeline, the parking location zone will be used in
lieu of the destination zone.</p>
<p>Core Table: <code class="docutils literal notranslate"><span class="pre">trips</span></code> | Result: <code class="docutils literal notranslate"><span class="pre">omx</span> <span class="pre">trip</span> <span class="pre">matrices</span></code> | Skims Keys: <code class="docutils literal notranslate"><span class="pre">origin,</span> <span class="pre">destination</span></code></p>
</section>
<section id="util">
<span id="utility-steps"></span><h2>Util<a class="headerlink" href="#util" title="Permalink to this heading">#</a></h2>
<p>Additional helper classes</p>
<section id="id33">
<h3>CDAP<a class="headerlink" href="#id33" title="Permalink to this heading">#</a></h3>
</section>
<section id="estimation">
<span id="table-annotation"></span><span id="index-2"></span><h3>Estimation<a class="headerlink" href="#estimation" title="Permalink to this heading">#</a></h3>
<p>See <a class="reference internal" href="estimation.html#estimation"><span class="std std-ref">Estimation</span></a> for more information.</p>
</section>
<section id="logsums">
<h3>Logsums<a class="headerlink" href="#logsums" title="Permalink to this heading">#</a></h3>
</section>
<section id="mode">
<h3>Mode<a class="headerlink" href="#mode" title="Permalink to this heading">#</a></h3>
</section>
<section id="overlap">
<h3>Overlap<a class="headerlink" href="#overlap" title="Permalink to this heading">#</a></h3>
</section>
<section id="tour-destination">
<h3>Tour Destination<a class="headerlink" href="#tour-destination" title="Permalink to this heading">#</a></h3>
</section>
<section id="tour-frequency">
<h3>Tour Frequency<a class="headerlink" href="#tour-frequency" title="Permalink to this heading">#</a></h3>
</section>
<section id="trip">
<h3>Trip<a class="headerlink" href="#trip" title="Permalink to this heading">#</a></h3>
</section>
<section id="vectorize-tour-scheduling">
<h3>Vectorize Tour Scheduling<a class="headerlink" href="#vectorize-tour-scheduling" title="Permalink to this heading">#</a></h3>
</section>
</section>
<section id="tests">
<h2>Tests<a class="headerlink" href="#tests" title="Permalink to this heading">#</a></h2>
<p>See <code class="docutils literal notranslate"><span class="pre">activitysim.abm.test</span></code> and <code class="docutils literal notranslate"><span class="pre">activitysim.abm.models.util.test</span></code></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="development.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Software Development</p>
      </div>
    </a>
    <a class="right-next"
       href="dev-guide/components/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Components</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize">Initialize</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-tvpb">Initialize LOS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessibility">Accessibility</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#disaggregate-accessibility">Disaggregate Accessibility</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#work-from-home">Work From Home</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#work-location">School Location</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Work Location</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shadow-pricing">Shadow Pricing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transit-pass-subsidy">Transit Pass Subsidy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transit-pass-ownership">Transit Pass Ownership</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#auto-ownership">Auto Ownership</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vehicle-type-choice">Vehicle Type Choice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#telecommute-frequency">Telecommute Frequency</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#free-parking-eligibility">Free Parking Eligibility</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinated-daily-activity-pattern">Coordinated Daily Activity Pattern</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mandatory-tour-frequency">Mandatory Tour Frequency</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#representative-logsums">Mandatory Tour Scheduling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#school-escorting">School Escorting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joint-tour-frequency">Joint Tour Frequency</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joint-tour-composition">Joint Tour Composition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joint-tour-participation">Joint Tour Participation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joint-tour-destination-choice">Joint Tour Destination Choice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joint-tour-scheduling">Joint Tour Scheduling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-mandatory-tour-frequency">Non-Mandatory Tour Frequency</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-mandatory-tour-destination-choice">Non-Mandatory Tour Destination Choice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-mandatory-tour-scheduling">Non-Mandatory Tour Scheduling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vehicle-allocation">Vehicle Allocation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tour-mode-choice">Tour Mode Choice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#at-work-subtours-frequency">At-work Subtours Frequency</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#at-work-subtours-destination-choice">At-work Subtours Destination Choice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#at-work-subtour-scheduling">At-work Subtour Scheduling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#at-work-subtour-mode">At-work Subtour Mode</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intermediate-stop-frequency">Intermediate Stop Frequency</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trip-purpose">Trip Purpose</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trip-destination-choice">Trip Destination Choice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trip-purpose-and-destination">Trip Purpose and Destination</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trip-scheduling-probabilistic">Trip Scheduling (Probabilistic)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trip-scheduling-choice-logit-choice">Trip Scheduling Choice (Logit Choice)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trip-departure-choice-logit-choice">Trip Departure Choice (Logit Choice)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trip-mode-choice">Trip Mode Choice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parking-location-choice">Parking Location Choice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#write-trip-matrices">Write Trip Matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#util">Util</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">CDAP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimation">Estimation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logsums">Logsums</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mode">Mode</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overlap">Overlap</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tour-destination">Tour Destination</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tour-frequency">Tour Frequency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trip">Trip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorize-tour-scheduling">Vectorize Tour Scheduling</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tests">Tests</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/models.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><!-- This will display the version of the docs -->
<p class="last-updated">
ActivitySim 1.2.2, documentation last updated Dec 02, 2023.<br/>
</p></div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>